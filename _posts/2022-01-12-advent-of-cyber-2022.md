---
title: Try Hack Me - Advent of Cyber 4 (2022)
date: 2022-12-01 00:28:00 -500
categories: [ctf,try hack me]
tags: [writeup,walkthrough,frameworks, log analysis]
---

After waiting for a full year, it's finally back! [Try Hack Me](https://tryhackme.com) is hosting their famous [Advent of Cyber](https://tryhackme.com/room/adventofcyber4) for the 4th time. It consists of a series of beginner challenges, which you can complete every day from the first of December until Christmas. I thought it would be cool to give it a go, so I'll try to update everyday (or as soon as I can) for the different challenges I complete.

They have a cool story following the whole duration of the challenges, which explains that we need to solve the challenges in order to save Christmas. I will not follow the story so much, so hope you just enjoy the challenges.

**Table of Contents**

- [Day 1 - Someone's coming to town! (Frameworks)](#day-1---someones-coming-to-town-frameworks)
- [Day 2 - Santa's Naughty and Nice Log (Log Analysis)](#day-2---santas-naughty-and-nice-log-log-analysis)
- [Next days incoming ...](#next-days-incoming-)

# Day 1 - Someone's coming to town! (Frameworks)

When we press on the *View Site* green button, we can see a website in which we have to solve 3 puzzles. Those are not too difficult, but they teach us about the different phases of the **Unified Kill Chain**. The puzzles look as follow: 

**Puzzle 1**

1. Research is part of my task, finding clues in public sources.
2. Simple documents I turn into malware.
3. A pizza, parcel or payload all have me as an action in common.
4. A con is the name of my game, tricking you into believing a false identity.
5. Weaknesses are my go-to resources; through them, I make my presence felt.
6. I am set up to let you back into the network after you leave.
7. Deletion of evidence is part of my process.
8. Communication with the compromised goes through me.

![puzzle 1](/images/adventofcyber_puzzle1.png)

**Puzzle 2**

1. I am an anchor that lets you go on an adventure and explore.
2. With me, you can locate new information to expand the attack.
3. Once a pawn, I became a King.
4. My payloads are triggered to infect all they come in contact with.
5. Passwords I collect are the keys to the mainframe.
6. Side to side, machine to machine, we hop.

![puzzle 2](/images/adventofcyber_puzzle2.png)

**Puzzle 3**

1. In your vault, I am in.
2. Like a dragon, I gather all valuable loot.
3. I export gathered treasures.
4. With me, your reputation goes tumbling down.
5. Goals set, goals attained. I win!

![puzzle 3](/images/adventofcyber_puzzle3.png)

After completing the 3 puzzles, we see a final page in which we get the info to answer the two questions of the challenge: 

**Who is the adversary that attacked Santa's network this year?**
`The Bandit Yeti`

**What's the flag that they left behind?**
`THM{IT'S A Y3T1 CHR1$TMA$}`

# Day 2 - Santa's Naughty and Nice Log (Log Analysis)

For today's challenge we are going to be taking a look at log files. For that, we start the machine and connect to it via `ssh`:

`ssh elfmcblue@IP_ADDRESS`

Introduce the password when prompted, and we can start answering the questions: 

**Use the ls command to list the files present in the current directory. How many log files are present?**

~~~
elfmcblue@day-2-log-analysis:~$ ls
SSHD.log  webserver.log
~~~

So the answer is `2` (`SSHD.log` and `webserver.log`).

**Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file?** Looks like it's the one called `webserver.log` (what a surprise).

**On what day was Santa's naughty and nice list stolen?**
We don't know how the list is called exactly, but let's assume it has either the word "naughty" or "nice".

~~~
elfmcblue@day-2-log-analysis:~$ grep naughty webserver.log 
10.10.249.191 - - [18/Nov/2022:12:35:18 +0000] "GET /naughty-james HTTP/1.1" 404 437 "-" "gobuster/3.0.1"
~~~

BINGO!

So the date is 18th of November of 2022. I tried a few ways of writing this down on the platform and nothing was working. Finally I looked for which day of the week 18th of November of 2022 was, and then the platform accepted it!

So the answer is `friday`.

**What is the IP address of the attacker?**
In the same line of the log retrieved for the previous question, we can see that the IP address used was `10.10.249.191`, so that's the answer.

**What is the name of the important list that the attacker stole from Santa?**
Since we know that the list has the structure `**********.***` (so, 10 characters, a dot, and 3 more characters), we can try to use the `grep -E` flag to use regex. The expression used is `[A-Za-z0-9]{10}\.[A-Za-z0-9]{3}`

~~~
elfmcblue@day-2-log-analysis:~$ grep -E "[A-Za-z0-9]{10}\.[A-Za-z0-9]{3}" webserver.log 
10.9.12.30 - - [18/Nov/2022:12:18:23 +0000] "GET /assets/css/stylesheet.e534de95c45f12e712642d4891fdc622837d0270dd58b129282e0e4b65b5df1a.css HTTP/1.1" 200 4526 "http://10.10.60.160/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36"
10.10.249.191 - - [18/Nov/2022:12:34:39 +0000] "GET /santaslist.txt HTTP/1.1" 200 133872 "-" "Wget/1.19.4 (linux-gnu)"
~~~

Not sure if my regex is nice and elegant, since I'm not good at it, but it worked, so we find that the list is `santaslist.txt`

**Look through the log files for the flag. The format of the flag is: THM{}**
Since we know part of the structure of the flag, it will be easy to get it with another grep. 
First we try the `webserver.log` file:

~~~
elfmcblue@day-2-log-analysis:~$ grep THM webserver.log 
10.10.249.191 - - [18/Nov/2022:12:35:20 +0000] "GET /AU7VTHM1YVYV8 HTTP/1.1" 404 437 "-" "gobuster/3.0.1"
~~~

mmmm so there is a line which contains "THM", but that's not the flag. Let's try it on the other log file (`SSHD.log`)
~~~
elfmcblue@day-2-log-analysis:~$ grep "THM" SSHD.log
THM{STOLENSANTASLIST}
~~~

There it is! Second day solved


# Next days incoming ...