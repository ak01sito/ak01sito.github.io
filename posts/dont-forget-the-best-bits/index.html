<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Reply Challenges - Don’t Forget the Best Bits" /><meta property="og:locale" content="en" /><meta name="description" content="This post is an attempt to document what I learned during the crypto200 challenge organized by Reply Challenges last weekend. It was my first CTF and for sure not the last one!" /><meta property="og:description" content="This post is an attempt to document what I learned during the crypto200 challenge organized by Reply Challenges last weekend. It was my first CTF and for sure not the last one!" /><link rel="canonical" href="https://ak01sito.github.io/posts/dont-forget-the-best-bits/" /><meta property="og:url" content="https://ak01sito.github.io/posts/dont-forget-the-best-bits/" /><meta property="og:site_name" content="ak01sito" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-17T07:28:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Reply Challenges - Don’t Forget the Best Bits" /><meta name="twitter:site" content="@ak01sito" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-01T18:02:53+01:00","datePublished":"2022-10-17T07:28:00+02:00","description":"This post is an attempt to document what I learned during the crypto200 challenge organized by Reply Challenges last weekend. It was my first CTF and for sure not the last one!","headline":"Reply Challenges - Don’t Forget the Best Bits","mainEntityOfPage":{"@type":"WebPage","@id":"https://ak01sito.github.io/posts/dont-forget-the-best-bits/"},"url":"https://ak01sito.github.io/posts/dont-forget-the-best-bits/"}</script><title>Reply Challenges - Don't Forget the Best Bits | ak01sito</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ak01sito"><meta name="application-name" content="ak01sito"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/37373077?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ak01sito</a></div><div class="site-subtitle font-italic">Security Analyst / Wannabe Pentester</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ak01sito" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ak01sito" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Reply Challenges - Don't Forget the Best Bits</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Reply Challenges - Don't Forget the Best Bits</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1665984480" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 17, 2022 </em> </span> <span> Updated <em class="" data-ts="1669914173" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 1, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Mireia</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2003 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><p>This post is an attempt to document what I learned during the crypto200 challenge organized by <a href="https://challenges.reply.com/tamtamy/home.action">Reply Challenges</a> last weekend. It was my first CTF and for sure not the last one!</p><p><strong>Table of Contents</strong></p><ul><li><a href="#overview">Overview</a><li><a href="#getting-the-right-user">Getting the Right User</a><li><a href="#understanding-the-algorithm">Understanding the Algorithm</a><li><a href="#bit-flipping">Bit Flipping</a><li><a href="#implementation">Implementation</a></ul><h1 id="overview">Overview</h1><p>To solve the challenge, we had some files to download (<code class="language-plaintext highlighter-rouge">notes.txt</code>, <code class="language-plaintext highlighter-rouge">app.snippet</code>, <code class="language-plaintext highlighter-rouge">_aes.py</code>) as well as a <a href="http://gamebox1.reply.it/14de018c45487063d3bc11fe33ac7e6996914988/">URL</a>. To find out what we need to solve here, let’s take a look at all those things they gave us.</p><p>On the URL we could find a textbox with a submit button, and a message telling us to submit an encrypted message. <img data-src="/images/reply-crypto200-web.png" alt="website" data-proofer-ignore></p><p>When we enter any random message, we get the text <code class="language-plaintext highlighter-rouge">Bad ciphertext provided!</code>.</p><p>Regarding the files, first we had <code class="language-plaintext highlighter-rouge">notes.txt</code> with the following content:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre># challenge title
Don't forget the best bits
&gt;
# examples
Cleartext: message%3DFor%20a%20fullfilling%20experience%20embrace%20listen%20to%20new%20music%2E%20Pay%20attention%20to%20details%2C%20titles%20are%20important%2E%20And%20remember%2C%20music%20it%27s%20flipping%20amazing%26user%3Dmario

AES-CBC 128bit Ciphertext: 482c74deadaee362185c315aa10bcd02c96d2417fe3d1adf7fd90da2da95ca16ff9bb7b20b1ed3ac22c93bd3ac7f8d790768379407181f93bbc2c5bde5da5a4e47b400ed0827d815c47b4793349d894a557dd4436a7e2d7967b09faeff6b7037e5ba40202e850c0640414ffd651847bff2fe50ac248ac63cd595339b6fa9ee78f2835d29176d524ab9116894eab6ad5fd56c6600670d1f5bc4e48dfdaed740d1e3b3f1c05a067fbeb69e0a67226755569f185120d5b393131ecd3c209123994135a62d029cc5072264cd6ca306a7d1fc8a63ae9b9675ecace48745f049d5d742639e2df80675ad114938eb641a8b1704
</pre></table></code></div></div><p>We can see a plaintext/cleartext and its respective ciphertext. If we URL decode the plaintext for easier reading, we clearly see that it contains two parameters <em>message</em> and <em>user</em>.</p><p><code class="language-plaintext highlighter-rouge">message=For a fullfilling experience embrace listen to new music. Pay attention to details, titles are important. And remember, music it's flipping amazing&amp;user=mario</code></p><p><em>message</em> seems to be giving us a lot of clues about the challenge, so we’ll come back to it when we have more info. <em>user</em> is <code class="language-plaintext highlighter-rouge">mario</code>. If we enter the ciphertext into the website, we get the text <code class="language-plaintext highlighter-rouge">Thank you for your feedback!</code>.</p><p>The second file (<code class="language-plaintext highlighter-rouge">app.snippet</code>) contained this:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>import _aes

if request.method == 'POST':
	ct = request.form.get("ciphertext")
		pt = _aes.decrypt(ct)
		params = parse_qs(unquote(pt))
		message = ''.join(params['message'])
		user = ''.join(params['user'])
		if user == user_flag:
			return make_response(flag,200)
		elif len(message) &gt; 0:
			return make_response("Thank you for your feedback!", 200)


</pre></table></code></div></div><p>Looks like they are showing us a part of what the server does with the data we sent to the previously mentioned website. Basically, it’s taking two parameters (<em>user</em> and <em>message</em>, like in the previous file. Coincidence? I don’t think so), and checking if the user equals an unknown <code class="language-plaintext highlighter-rouge">user_flag</code> variable, in which case it returns the flag. Seems obvious then that we’ll have to craft a text like the one shown before, in which <code class="language-plaintext highlighter-rouge">user = user_flag</code>. Let’s see the third file and come back to this later.</p><p>In the third file (<code class="language-plaintext highlighter-rouge">_aes.py</code>) we see the following info:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span><span class="p">,</span><span class="n">unpad</span>

<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">):</span>
    <span class="n">aes</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
    <span class="n">plaintext_padded</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">plaintext</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'unicode_escape'</span><span class="p">),</span> <span class="n">AES</span><span class="p">.</span><span class="n">block_size</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'pkcs7'</span><span class="p">)</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">aes</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext_padded</span><span class="p">).</span><span class="nb">hex</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ciphertext</span>
    
<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">):</span>
    <span class="n">aes</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
    <span class="n">plaintext_padded</span> <span class="o">=</span> <span class="n">aes</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">))</span>
    <span class="n">plaintext</span> <span class="o">=</span> <span class="n">unpad</span><span class="p">(</span><span class="n">plaintext_padded</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">block_size</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'pkcs7'</span><span class="p">).</span><span class="n">decode</span><span class="p">(</span><span class="s">'unicode_escape'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plaintext</span>

</pre></table></code></div></div><p>So they are showing us the encrypt and decrypt methods that the server is using. We obviously don’t see the <code class="language-plaintext highlighter-rouge">key</code> nor the <code class="language-plaintext highlighter-rouge">iv</code>, but we get some important info. </p><ul><li>It is using <code class="language-plaintext highlighter-rouge">AES</code> with <code class="language-plaintext highlighter-rouge">CBC mode</code><li>It is using padding <code class="language-plaintext highlighter-rouge">pkcs7</code></ul><p>We have two questions to solve then.</p><ol><li>Which user is the correct one that will give us the flag?<li>How do we craft a modified message which the server can decrypt, if we don’t have the <code class="language-plaintext highlighter-rouge">key</code> nor the <code class="language-plaintext highlighter-rouge">iv</code> used by the server?</ol><h1 id="getting-the-right-user">Getting the Right User</h1><p>Let’s first deal with the easier question. In the first file, we got quite an insistent message, telling us to “listen to new music”, to “check the titles”, and again telling us that music is “flipping amazing”. They also wrote the title (“Don’t forget the best bits”) again in the file, even though we could see it on the web at any point. Seems like they are trying to tell us something…</p><p><img data-src="/images/reply-crypto200-search.png" alt="website" data-proofer-ignore></p><p>Yup, that’s definitely it. The first idea I’m getting is that the user could be <code class="language-plaintext highlighter-rouge">Franz</code>, since that’s the name of the band. After looking at the lyrics, though, I see a lot of mentions of <code class="language-plaintext highlighter-rouge">Billy</code>. So when it’s time to insert the user, I’ll try both of those.</p><h1 id="understanding-the-algorithm">Understanding the Algorithm</h1><p>As we saw, they are using <code class="language-plaintext highlighter-rouge">AES</code> (or Advanced Encryption Standard) with the <code class="language-plaintext highlighter-rouge">CBC mode</code> (or Cipher Block Chaining mode). The way this algorithm encrypts is first dividing the plaintext in blocks of 16 bytes or characters. The <code class="language-plaintext highlighter-rouge">key</code> is then used on each block in order to encrypt them. <strong>Yet that’s not everything.</strong> In addition, each block of ciphertext C<sub>i</sub> is used to perform an <em>XOR</em> operation on the next plaintext block P<sub>i+1</sub>before it gets encrypted. This way, two identical blocks would never look the same even though they are encrypted using the same key. In order to <em>XOR</em> the first plaintext block we use an <code class="language-plaintext highlighter-rouge">iv</code> (Initial Vector). The following picture illustrates this:</p><p><img data-src="/images/reply-crypto200-cbc-encryption.png" alt="website" data-proofer-ignore></p><p>What happens then if the last block is shorter than 16 bytes? Well, that’s when the padding comes into play. It adds the necessary bytes. What’s important it’s to notice that with <code class="language-plaintext highlighter-rouge">pkcs7</code>, if the last block is 16 bytes (which would mean that all blocks are complete and so we don’t need any extra padding), the algorithm <strong>adds padding anyway</strong>, and so we get an extra block which consists of 16 bytes of padding. The plaintext and ciphertext we are given as examples would then look like this:</p><p><img data-src="/images/reply-crypto200-clear-cipher.png" alt="website" data-proofer-ignore></p><blockquote><p>First line = plaintext without padding Second line = plaintext with padding Third line = ciphertext</p></blockquote><p>In order to decrypt, we use the reverse process than to encrypt, so each ciphertext C<sub>i</sub> is used to reveal the plaintext block P<sub>i+1</sub> as shown in the pic:</p><p><img data-src="/images/reply-crypto200-cbc-decryption.png" alt="website" data-proofer-ignore></p><h1 id="bit-flipping">Bit Flipping</h1><p>I’ll admit I was a bit lost at the beginning. How can I generate a new ciphertext with a different username if I’m missing the <code class="language-plaintext highlighter-rouge">key</code> and the <code class="language-plaintext highlighter-rouge">iv</code>? It made no sense. I thought about padding oracle. Since the 16 byte padding seemed, in my absolute ignorance on the topic, like a curious thing to have.</p><p>After a while, I remembered the time a good friend of mine solved a crypto problem with something called bit flipping attack… and… that sounds familiar… could it be…</p><p><code class="language-plaintext highlighter-rouge">music it's flipping amazing</code></p><p>They wrote this in the first file I read! Ok, it had to be this. I was investigating the bit flipping attack for a while, and came across <a href="https://alicegg.tech/2019/06/23/aes-cbc.html">this post</a>: and I just saw it SO CLEARLY. So let’s explain it a bit.</p><p>This attack works when we manage to get into our hands a ciphertext and its respective plaintext (Oh wait, we do!). Since the blocks have a specific length, we know in which block the data we need/want to modify is, and also which block of ciphertext will perform the <em>XOR</em> operation on this data after its decryption. Using our challenge as example, we know that the data is on block C<sub>i+1</sub> (since we can read it in P<sub>i+1</sub>), and we also know that C<sub>i</sub> will be XORed with it in order to reveal the plaintext P<sub>i+1</sub>. <img data-src="/images/reply-crypto200-clear-cipher.png" alt="website" data-proofer-ignore></p><p>That means, that we can change some parts of a ciphertext block C<sub>i</sub>, and that will end affecting the result of the next plaintext block P<sub>i+1</sub>.</p><p>Due to the way <em>XOR</em> works, if we <em>XOR</em> the original plaintext block P<sub>i+1</sub> (the one containing the user <code class="language-plaintext highlighter-rouge">mario</code>) with the exact same block with the user we want, we will get the difference of those two. In other words, we will get the exact bits we need to change to <code class="language-plaintext highlighter-rouge">mario</code> so that it says <code class="language-plaintext highlighter-rouge">billy</code>. In this case, we have:</p><p><code class="language-plaintext highlighter-rouge">"g%26user%3Dmario" XOR "g%26user%3Dbilly" = "00000000000000000000000f081e0516"</code></p><p>Those bits are the ones that the ciphertext block C<sub>i</sub> needs to have different in order to modify P<sub>i+1</sub> while being decrypted. For that, we will now <em>XOR</em> C<sub>i</sub> with the result of the previous <em>XOR</em>. So at the end we have</p><p><code class="language-plaintext highlighter-rouge">"00000000000000000000000f081e0516" XOR "35a62d029cc5072264cd6ca306a7d1fc"</code></p><p>There are two cases when using this attack: <img data-src="/images/reply-crypto200-bit-flipping.png" alt="website" data-proofer-ignore></p><p>In the green case (ideal case), since we modify the <code class="language-plaintext highlighter-rouge">iv</code> (which won’t need to be decrypted) we attack and modify directly the first plaintext block, and so we cleanly obtain the result we want. This, of course, is only useful if the data we want to modify is on the first 16 characters of the ciphertext we obtained (and if we can actually see and modify the <code class="language-plaintext highlighter-rouge">iv</code>). We cannot do either of those things, so this case does not apply to us here. </p><p>In the second case (red), we modify a ciphertext block C<sub>i</sub>, which will be _XOR_ed with the next block and produce the P<sub>i+1</sub> plaintext. Modifying a ciphertext C<sub>i</sub> means that the plaintext P<sub>i</sub> will be completely corrupted and unusable. But what if we do not care about what is written there? Then we could apply the bit flipping attack the same way as if C<sub>i</sub> was the <code class="language-plaintext highlighter-rouge">iv</code>.</p><p>In our case the block C<sub>i</sub> contains part of a message which is completely irrelevant for us (<code class="language-plaintext highlighter-rouge">lipping%20amazin</code>). Since it doesn’t look like the server will be checking it, we can perform the flipping attack using the second case.</p><h1 id="implementation">Implementation</h1><p>Now that we know exactly what to do, let’s do it!</p><p>First of all, we want to know <strong>which exact bits we need to flip in P<sub>i+1</sub></strong> so that instead of <code class="language-plaintext highlighter-rouge">mario</code>, the user is either <code class="language-plaintext highlighter-rouge">billy</code> or <code class="language-plaintext highlighter-rouge">franz</code>. See that both usernames are still possible since they have the same number of characters than user <code class="language-plaintext highlighter-rouge">mario</code>. We can only flip bits, but not add new ones or remove them. I will use <code class="language-plaintext highlighter-rouge">billy</code> for the explanation below, but the process will be the same with the other username.</p><p>To know the bits that need to be different, we need to <em>XOR</em> the two plaintext block messages:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">xor_messages</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">32</span><span class="p">):</span>
    <span class="c1"># messages must be in hexadecimal like "9bc423909ac569b5016525cb4b2660b5"
</span>    <span class="n">bina</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">16</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">binb</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">16</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bina</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="nb">int</span><span class="p">(</span><span class="n">binb</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">hex</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="mi">2</span><span class="p">:].</span><span class="n">zfill</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

<span class="n">current_message</span> <span class="o">=</span> <span class="s">"g%26user%3Dmario"</span>
<span class="n">wanted_message</span> <span class="o">=</span> <span class="s">"g%26user%3Dbilly"</span>

<span class="n">hex_current_message</span> <span class="o">=</span> <span class="n">current_message</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">).</span><span class="nb">hex</span><span class="p">()</span>
<span class="n">hex_wanted_message</span> <span class="o">=</span> <span class="n">wanted_message</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">).</span><span class="nb">hex</span><span class="p">()</span>

<span class="n">diff_bits</span> <span class="o">=</span> <span class="n">xor_messages</span><span class="p">(</span><span class="n">hex_current_message</span><span class="p">,</span><span class="n">hex_wanted_message</span><span class="p">)</span>

</pre></table></code></div></div><p>And then, we <em>XOR</em> those bits to the ciphertext block C<sub>i</sub>. In this case, due to the extra padding block explained before, that was the third to last block.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">cipher_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">ciphertext</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">32</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">),</span> <span class="mi">32</span><span class="p">)]</span>
<span class="n">wanted_block</span> <span class="o">=</span> <span class="n">cipher_blocks</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>

<span class="n">bit_flipping</span> <span class="o">=</span> <span class="n">xor_messages</span><span class="p">(</span><span class="n">wanted_block</span><span class="p">,</span> <span class="n">diff_bits</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">cipher_blocks</span><span class="p">[:</span><span class="mi">12</span><span class="p">])</span> <span class="o">+</span> <span class="n">bit_flipping</span> <span class="o">+</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">cipher_blocks</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
</pre></table></code></div></div><p>When we execute the script we get the new ciphertext: <code class="language-plaintext highlighter-rouge">482c74deadaee362185c315aa10bcd02c96d2417fe3d1adf7fd90da2da95ca16ff9bb7b20b1ed3ac22c93bd3ac7f8d790768379407181f93bbc2c5bde5da5a4e47b400ed0827d815c47b4793349d894a557dd4436a7e2d7967b09faeff6b7037e5ba40202e850c0640414ffd651847bff2fe50ac248ac63cd595339b6fa9ee78f2835d29176d524ab9116894eab6ad5fd56c6600670d1f5bc4e48dfdaed740d1e3b3f1c05a067fbeb69e0a67226755569f185120d5b393131ecd3c209123994135a62d029cc5072264cd6cac0eb9d4ea8a63ae9b9675ecace48745f049d5d742639e2df80675ad114938eb641a8b1704</code></p><p>If we repeat this process with the other username, we now get two ciphertexts to try on the website. And the winner was… <code class="language-plaintext highlighter-rouge">billy</code>!!:</p><p><img data-src="/images/reply-crypto200-flag.png" alt="website" data-proofer-ignore></p><p>Whoooop whoooop!</p><div style="padding: 15px; border: 1px solid transparent; border-color: transparent; margin-bottom: 20px; border-radius: 4px; color: #a94442; background-color: #f2dede; border-color: #ebccd1;"> Initially I coded the script so that it would perform the bit flipping on the last block (the padding one). I though it made sense that I could change it since it was not relevant... Next time let's make sure you understand how the algorithm works before flipping things...</div><p>Here you can see the whole script I used:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="c1"># --------- DATA -------------
</span>
<span class="n">block_size</span> <span class="o">=</span> <span class="mi">16</span> <span class="c1"># 16 byes = 16 characters
</span><span class="n">cipher_block_size</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">cleartext</span> <span class="o">=</span> <span class="s">"message%3DFor%20a%20fullfilling%20experience%20embrace%20listen%20to%20new%20music%2E%20Pay%20attention%20to%20details%2C%20titles%20are%20important%2E%20And%20remember%2C%20music%20it%27s%20flipping%20amazing%26user%3Dmario"</span>

<span class="c1"># even though the cleartext has 14 blocks, the ciphertext will have 15, since the last block is 16 bytes long, and so the padding adds a new block of 16 characters
</span><span class="n">ciphertext</span> <span class="o">=</span> <span class="s">"482c74deadaee362185c315aa10bcd02c96d2417fe3d1adf7fd90da2da95ca16ff9bb7b20b1ed3ac22c93bd3ac7f8d790768379407181f93bbc2c5bde5da5a4e47b400ed0827d815c47b4793349d894a557dd4436a7e2d7967b09faeff6b7037e5ba40202e850c0640414ffd651847bff2fe50ac248ac63cd595339b6fa9ee78f2835d29176d524ab9116894eab6ad5fd56c6600670d1f5bc4e48dfdaed740d1e3b3f1c05a067fbeb69e0a67226755569f185120d5b393131ecd3c209123994135a62d029cc5072264cd6ca306a7d1fc8a63ae9b9675ecace48745f049d5d742639e2df80675ad114938eb641a8b1704"</span>


<span class="c1"># ---------- FLIPPING -------------
</span><span class="k">def</span> <span class="nf">xor_messages</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">32</span><span class="p">):</span>
    <span class="c1"># messages must be in hexadecimal like "9bc423909ac569b5016525cb4b2660b5"
</span>    <span class="n">bina</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">16</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">binb</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">16</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bina</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="nb">int</span><span class="p">(</span><span class="n">binb</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">hex</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="mi">2</span><span class="p">:].</span><span class="n">zfill</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    

<span class="n">cipher_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">ciphertext</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">cipher_block_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">),</span> <span class="n">cipher_block_size</span><span class="p">)]</span>
<span class="n">wanted_block</span> <span class="o">=</span> <span class="n">cipher_blocks</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>

<span class="n">current_message</span> <span class="o">=</span> <span class="n">cleartext</span><span class="p">[</span><span class="o">-</span><span class="n">block_size</span><span class="p">:]</span> <span class="c1"># g%26user%3Dmario
</span><span class="n">hex_current_message</span> <span class="o">=</span> <span class="n">current_message</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">).</span><span class="nb">hex</span><span class="p">()</span>

<span class="n">possible_messages</span> <span class="o">=</span> <span class="p">[</span><span class="s">"g%26user%3Dfranz"</span><span class="p">,</span> <span class="s">"g%26user%3Dbilly"</span><span class="p">]</span>

<span class="k">for</span> <span class="n">wanted_message</span> <span class="ow">in</span> <span class="n">possible_messages</span><span class="p">:</span>
    <span class="n">hex_wanted_message</span> <span class="o">=</span> <span class="n">wanted_message</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">).</span><span class="nb">hex</span><span class="p">()</span>

    <span class="n">diff_bits</span> <span class="o">=</span> <span class="n">xor_messages</span><span class="p">(</span><span class="n">hex_current_message</span><span class="p">,</span><span class="n">hex_wanted_message</span><span class="p">)</span>
    <span class="n">bit_flipping</span> <span class="o">=</span> <span class="n">xor_messages</span><span class="p">(</span><span class="n">wanted_block</span><span class="p">,</span> <span class="n">diff_bits</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">cipher_blocks</span><span class="p">[:</span><span class="mi">12</span><span class="p">])</span> <span class="o">+</span> <span class="n">bit_flipping</span> <span class="o">+</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">cipher_blocks</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>

    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
</pre></table></code></div></div><p>I learned a lot solving this challenge and wanted to document the whole process and the new knowledge. So grateful to <a href="https://challenges.reply.com/tamtamy/home.action">Reply Challenges</a> for an amazing event!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>ctf</a>, <a href='/categories/reply-challenges/'>reply challenges</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/walkthrough/" class="post-tag no-text-decoration" >walkthrough</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/crypto/" class="post-tag no-text-decoration" >crypto</a> <a href="/tags/aes/" class="post-tag no-text-decoration" >aes</a> <a href="/tags/cbc/" class="post-tag no-text-decoration" >cbc</a> <a href="/tags/bit-flipping/" class="post-tag no-text-decoration" >bit_flipping</a> <a href="/tags/reply/" class="post-tag no-text-decoration" >reply</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Reply+Challenges+-+Don%27t+Forget+the+Best+Bits+-+ak01sito&url=https%3A%2F%2Fak01sito.github.io%2Fposts%2Fdont-forget-the-best-bits%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Reply+Challenges+-+Don%27t+Forget+the+Best+Bits+-+ak01sito&u=https%3A%2F%2Fak01sito.github.io%2Fposts%2Fdont-forget-the-best-bits%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fak01sito.github.io%2Fposts%2Fdont-forget-the-best-bits%2F&text=Reply+Challenges+-+Don%27t+Forget+the+Best+Bits+-+ak01sito" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/juggling-facts/">Hack The Box - Juggling Facts</a><li><a href="/posts/advent-of-cyber-2022/">Try Hack Me - Advent of Cyber 4 (2022)</a><li><a href="/posts/dont-forget-the-best-bits/">Reply Challenges - Don't Forget the Best Bits</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/aes/">aes</a> <a class="post-tag" href="/tags/bit-flipping/">bit_flipping</a> <a class="post-tag" href="/tags/brute-forcing/">brute-forcing</a> <a class="post-tag" href="/tags/cbc/">cbc</a> <a class="post-tag" href="/tags/code-review/">code review</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/email-analysis/">email analysis</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/android-in-the-middle/"><div class="card-body"> <em class="small" data-ts="1676006880" data-df="ll" > Feb 10, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Android-in-the-Middle</h3><div class="text-muted small"><p> I’m back at it again with another little challenge from HackTheBox. This time it’s a crypto one, called Android-in-the-Middle. To know what we have to do and how to get the flag, let’s look at the...</p></div></div></a></div><div class="card"> <a href="/posts/advent-of-cyber-2022/"><div class="card-body"> <em class="small" data-ts="1669872480" data-df="ll" > Dec 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Try Hack Me - Advent of Cyber 4 (2022)</h3><div class="text-muted small"><p> After waiting for a full year, it’s finally back! Try Hack Me is hosting their famous Advent of Cyber for the 4th time. It consists of a series of beginner challenges, which you can complete every ...</p></div></div></a></div><div class="card"> <a href="/posts/juggling-facts/"><div class="card-body"> <em class="small" data-ts="1675661280" data-df="ll" > Feb 6, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Juggling Facts</h3><div class="text-muted small"><p> Today I was feeling inspired and decided to give a try to a HackTheBox challenge. I decided to go for the Juggling facts one. This is a Web challenge which was introduced in the HackTheBoo beginner...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"><div class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></div><a href="/posts/advent-of-cyber-2022/" class="btn btn-outline-primary" prompt="Newer"><p>Try Hack Me - Advent of Cyber 4 (2022)</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Mireia</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/aes/">aes</a> <a class="post-tag" href="/tags/bit-flipping/">bit_flipping</a> <a class="post-tag" href="/tags/brute-forcing/">brute-forcing</a> <a class="post-tag" href="/tags/cbc/">cbc</a> <a class="post-tag" href="/tags/code-review/">code review</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/email-analysis/">email analysis</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
